<?xml version="1.0" encoding="utf-8" standalone="yes" ?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
  <channel>
    <title>Site Performance on Sajal Kayan</title>
    <link>https://www.sajalkayan.com/tag/site-performance.xml</link>
    <description>Recent content in Site Performance on Sajal Kayan</description>
    <generator>Hugo -- gohugo.io</generator>
    <language>en-us</language>
    <atom:link href="https://www.sajalkayan.com/tag/site-performance.xml" rel="self" type="application/rss+xml" />
    
    <item>
      <title>Using Cloudflare&#39;s 1.1.1.1 might lead to slower CDN performance</title>
      <link>https://www.sajalkayan.com/post/cloudflare-1dot1dot1dot1.html</link>
      <pubDate>Sat, 21 Apr 2018 17:46:45 +0000</pubDate>
      
      <guid>https://www.sajalkayan.com/post/cloudflare-1dot1dot1dot1.html</guid>
      <description>&lt;p&gt;&lt;strong&gt;Disclaimer: All views expressed here are personal&lt;/strong&gt;&lt;/p&gt;

&lt;p&gt;Recently Cloudflare launched their &lt;a href=&#34;https://1.1.1.1/&#34;&gt;1.1.1.1&lt;/a&gt; public resolver in partnership with APNIC to great fan-fare boasting  performance improvements and increased privacy.&lt;/p&gt;

&lt;p&gt;While their claims are true, I would like to talk about them &lt;a href=&#34;https://developers.cloudflare.com/1.1.1.1/nitty-gritty-details/#edns-client-subnet&#34;&gt;not forwarding&lt;/a&gt; &lt;a href=&#34;https://tools.ietf.org/html/rfc7871&#34;&gt;EDNS client subnet&lt;/a&gt;(ECS). &lt;a href=&#34;https://www.quad9.net/&#34;&gt;Quad9&lt;/a&gt; does something similar, but provide an &lt;a href=&#34;https://www.quad9.net/faq/#Is_there_a_service_that_Quad9_offers_that_does_not_have_the_blocklist_or_other_security&#34;&gt;ECS capable IP&lt;/a&gt; hidden in the docs for users who really care about performance.&lt;/p&gt;

&lt;p&gt;In 2010 I &lt;a href=&#34;https://www.sajalkayan.com/in-a-cdnd-world-opendns-is-the-enemy.html&#34;&gt;wrote a post&lt;/a&gt; outlining how using public DNS resolvers leads to degraded performance when accessing non-anycast CDNs. We have come a long way since then, with EDNS Client Subnet being supported by most public resolvers, and a wider pop footprint, that blogpost is very outdated.&lt;/p&gt;

&lt;p&gt;According to Cloudflare&lt;/p&gt;

&lt;blockquote&gt;
&lt;p&gt;1.1.1.1 is a privacy centric resolver so it does not send any client IP information and does not send the EDNS Client Subnet Header to authoritative servers&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;If I do a DNS lookup for &lt;code&gt;cdn.example.com&lt;/code&gt;, it is with the intent of connecting to that website(over HTTP/HTTPS/TCP/whatever). The concern appears to be the CDN&amp;rsquo;s authoritative DNS service provider being able to see the subnet of the end user. Sure that is one way some information about the user could &lt;em&gt;leak&lt;/em&gt;. But /24 is not a strong indicator to identify specific user.&lt;/p&gt;

&lt;p&gt;When I do make the final connection, I am sending my whole /32 IP address. The /24 (or /28) that would have been sent is hardly any privacy concern compared to the exact IP that&amp;rsquo;s needed to be exposed while making a TCP connection.&lt;/p&gt;

&lt;p&gt;While visiting a typical website, A user exposes their full IP to potentially following parties&lt;/p&gt;

&lt;ol&gt;
&lt;li&gt;The website&amp;rsquo;s server&lt;/li&gt;
&lt;li&gt;The website&amp;rsquo;s loadbalancer (if any - Like AWS ELB, digital ocean, etc)&lt;/li&gt;
&lt;li&gt;The website&amp;rsquo;s hosting provider (AWS, DO, Google, etc etc&amp;hellip;)&lt;/li&gt;
&lt;li&gt;1 - 3 for all 3rd party objects on the webpage (including their CDNs).&lt;/li&gt;
&lt;li&gt;All network devices sitting in between 1 - 4&lt;/li&gt;
&lt;/ol&gt;

&lt;p&gt;Authoritative DNS service provider is just another piece of a website&amp;rsquo;s hosting infrastructure, which with ECS only gets partial IP. Sending partial IP, IMHO, is a very trivial privacy concern in comparison to the potential benefits.&lt;/p&gt;

&lt;p&gt;For a non-anycast CDN, to get accurate DNS-based routing from user of 1.1.1.1, the following must work flawlessly.&lt;/p&gt;

&lt;ol&gt;
&lt;li&gt;Internal POP IP of Cloudflare must be very accurate in geoip databases like MaxMind and friends.&lt;/li&gt;
&lt;li&gt;The user must always be routed to closest Cloudflare POP. If for some reason the path is wrong, then along with slower Cloudflare, users will experience slower all-CDNs.&lt;/li&gt;
&lt;/ol&gt;

&lt;p&gt;But&amp;hellip; Doesn&amp;rsquo;t Cloudflare have POPs &lt;a href=&#34;https://www.cloudflare.com/network/&#34;&gt;almost everywhere&lt;/a&gt;?&lt;/p&gt;

&lt;p&gt;Yes. But that only gives somewhat geographical granularity. What about ISP-level optimizations. I would like to only send users on Verizon from San Francisco to my Verizon POP. If that user uses 1.1.1.1, they don&amp;rsquo;t benefit from all the money I spent in setting up that POP. If another CDN has more locations than Cloudflare, then for a 1.1.1.1 user the CDN has to limit their service based on Cloudflare&amp;rsquo;s network map. CDNs who host closer to the Edge are impacted more than ones who host at hubs.&lt;/p&gt;

&lt;p&gt;Some tests using &lt;a href=&#34;https://github.com/turbobytes/dnsperfbench&#34;&gt;dnsperfbench&lt;/a&gt; tool&amp;rsquo;s &lt;a href=&#34;https://github.com/turbobytes/dnsperfbench/blob/httptest/README.md#httptest&#34;&gt;httptest&lt;/a&gt; feature. Basically for each resolver it figures out what IP the resolver is returning for Akamai, and then running HTTPS tests over it.&lt;/p&gt;

&lt;p&gt;Choosing Akamai as the target of this test was an intentional selection bias on my end to highlight the issue at hand.&lt;/p&gt;

&lt;p&gt;From Thailand/&lt;a href=&#34;https://www.ais.co.th/fibre/en/&#34;&gt;AIS Fiber&lt;/a&gt; (first hop adds ~20ms latency!)&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;$ dnsperfbench -resolver 115.178.58.10 -httptest https://turbobytes.akamaized.net/static/rum/100kb-image.jpg
2018/04/21 20:09:47 Resolving
2018/04/21 20:10:00 Issuing HTTP(s) tests
&lt;/code&gt;&lt;/pre&gt;

&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;RESOLVER&lt;/th&gt;
&lt;th&gt;REMOTE&lt;/th&gt;
&lt;th align=&#34;right&#34;&gt;DNS&lt;/th&gt;
&lt;th align=&#34;right&#34;&gt;CONNECT&lt;/th&gt;
&lt;th align=&#34;right&#34;&gt;TLS&lt;/th&gt;
&lt;th align=&#34;right&#34;&gt;TTFB&lt;/th&gt;
&lt;th align=&#34;right&#34;&gt;TRANSFER&lt;/th&gt;
&lt;th align=&#34;right&#34;&gt;TOTAL&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;

&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;&lt;code&gt;115.178.58.10&lt;/code&gt; (Unknown)&lt;/td&gt;
&lt;td&gt;49.231.112.9:443&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;26ms&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;23ms&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;83ms&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;25ms&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;40ms&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;197ms&lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
&lt;td&gt;&lt;code&gt;9.9.9.9&lt;/code&gt; (Quad9)&lt;/td&gt;
&lt;td&gt;202.183.253.10:443&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;56ms&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;25ms&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;89ms&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;26ms&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;43ms&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;238ms&lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
&lt;td&gt;&lt;code&gt;208.67.222.222&lt;/code&gt; (OpenDNS)&lt;/td&gt;
&lt;td&gt;49.231.112.33:443&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;71ms&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;23ms&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;83ms&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;25ms&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;40ms&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;242ms&lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
&lt;td&gt;&lt;code&gt;8.8.8.8&lt;/code&gt; (Google)&lt;/td&gt;
&lt;td&gt;49.231.112.9:443&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;110ms&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;24ms&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;84ms&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;24ms&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;40ms&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;281ms&lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
&lt;td&gt;&lt;code&gt;[2001:4860:4860::8888]&lt;/code&gt; (Google)&lt;/td&gt;
&lt;td&gt;49.231.112.33:443&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;111ms&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;24ms&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;83ms&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;24ms&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;41ms&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;282ms&lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
&lt;td&gt;&lt;code&gt;[2620:0:ccc::2]&lt;/code&gt; (OpenDNS)&lt;/td&gt;
&lt;td&gt;49.231.112.33:443&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;156ms&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;24ms&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;82ms&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;24ms&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;40ms&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;326ms&lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
&lt;td&gt;&lt;code&gt;[2606:4700:4700::1111]&lt;/code&gt; (Cloudflare)&lt;/td&gt;
&lt;td&gt;&lt;strong&gt;23.49.60.192:443&lt;/strong&gt;&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;53ms&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;53ms&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;114ms&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;53ms&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;69ms&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;&lt;strong&gt;342ms&lt;/strong&gt;&lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
&lt;td&gt;&lt;code&gt;1.1.1.1&lt;/code&gt; (Cloudflare)&lt;/td&gt;
&lt;td&gt;&lt;strong&gt;23.49.60.192:443&lt;/strong&gt;&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;54ms&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;56ms&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;120ms&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;57ms&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;72ms&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;&lt;strong&gt;358ms&lt;/strong&gt;&lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
&lt;td&gt;&lt;code&gt;199.85.126.20&lt;/code&gt; (Norton)&lt;/td&gt;
&lt;td&gt;23.52.171.99:443&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;89ms&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;62ms&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;130ms&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;60ms&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;85ms&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;426ms&lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
&lt;td&gt;&lt;code&gt;180.76.76.76&lt;/code&gt; (Baidu)&lt;/td&gt;
&lt;td&gt;23.2.16.27:443&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;129ms&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;86ms&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;180ms&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;86ms&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;123ms&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;605ms&lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
&lt;td&gt;&lt;code&gt;[2620:fe::fe]&lt;/code&gt; (Quad9)&lt;/td&gt;
&lt;td&gt;23.215.102.26:443&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;27ms&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;223ms&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;456ms&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;224ms&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;317ms&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;1.247s&lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
&lt;td&gt;&lt;code&gt;[2a0d:2a00:1::]&lt;/code&gt; (Clean Browsing)&lt;/td&gt;
&lt;td&gt;23.219.38.67:443&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;350ms&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;228ms&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;465ms&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;229ms&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;278ms&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;1.55s&lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
&lt;td&gt;&lt;code&gt;185.228.168.168&lt;/code&gt; (Clean Browsing)&lt;/td&gt;
&lt;td&gt;23.219.38.48:443&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;382ms&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;227ms&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;463ms&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;227ms&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;292ms&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;1.591s&lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
&lt;td&gt;&lt;code&gt;119.29.29.29&lt;/code&gt; (DNSPod)&lt;/td&gt;
&lt;td&gt;205.197.140.136:443&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;474ms&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;236ms&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;481ms&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;244ms&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;335ms&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;1.772s&lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
&lt;td&gt;&lt;code&gt;114.114.114.114&lt;/code&gt; (114dns)&lt;/td&gt;
&lt;td&gt;23.215.104.203:443&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;382ms&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;283ms&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;573ms&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;284ms&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;401ms&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;1.924s&lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
&lt;td&gt;&lt;code&gt;8.26.56.26&lt;/code&gt; (Comodo)&lt;/td&gt;
&lt;td&gt;104.86.110.154:443&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;219ms&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;280ms&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;566ms&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;279ms&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;648ms&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;1.993s&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;

&lt;p&gt;The fastest responding IP &lt;code&gt;49.231.112.x&lt;/code&gt; is hosted inside my ISP, next best is in another ISP in Thailand. If I were to use &lt;code&gt;1.1.1.1&lt;/code&gt; my access to things hosted with Akamai would get about 2x slower, in exchange for Akamai not getting to see my (partial) IP during DNS resolution.&lt;/p&gt;

&lt;p&gt;Sure, Cloudflare&amp;rsquo;s DNS service (which appears to be serving locally within this ISP) is new, perhaps Akamai has not updated their geoip databases with Cloudflare&amp;rsquo;s backend IPs, perhaps Cloudflare has not yet published them, but even with that fix, the best Akamai could do is send me to a &lt;em&gt;generic&lt;/em&gt; Thailand POP, instead of the one sitting at my ISP.&lt;/p&gt;

&lt;p&gt;Similarly for Thailand/&lt;a href=&#34;http://www.trueinternet.co.th/ENG/index.html&#34;&gt;True&lt;/a&gt;&lt;/p&gt;

&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;RESOLVER&lt;/th&gt;
&lt;th&gt;REMOTE&lt;/th&gt;
&lt;th align=&#34;right&#34;&gt;DNS&lt;/th&gt;
&lt;th align=&#34;right&#34;&gt;CONNECT&lt;/th&gt;
&lt;th align=&#34;right&#34;&gt;TLS&lt;/th&gt;
&lt;th align=&#34;right&#34;&gt;TTFB&lt;/th&gt;
&lt;th align=&#34;right&#34;&gt;TRANSFER&lt;/th&gt;
&lt;th align=&#34;right&#34;&gt;TOTAL&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;

&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;&lt;code&gt;203.144.206.49&lt;/code&gt; (Unknown)&lt;/td&gt;
&lt;td&gt;61.91.165.154:443&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;15ms&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;10ms&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;29ms&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;10ms&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;15ms&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;80ms&lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
&lt;td&gt;&lt;code&gt;9.9.9.9&lt;/code&gt; (Quad9)&lt;/td&gt;
&lt;td&gt;202.183.253.8:443&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;13ms&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;11ms&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;57ms&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;12ms&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;16ms&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;109ms&lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
&lt;td&gt;&lt;code&gt;8.8.8.8&lt;/code&gt; (Google)&lt;/td&gt;
&lt;td&gt;61.91.165.154:443&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;97ms&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;10ms&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;29ms&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;11ms&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;17ms&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;163ms&lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
&lt;td&gt;&lt;code&gt;208.67.222.222&lt;/code&gt; (OpenDNS)&lt;/td&gt;
&lt;td&gt;61.91.165.154:443&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;105ms&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;9ms&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;29ms&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;11ms&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;15ms&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;169ms&lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
&lt;td&gt;&lt;code&gt;199.85.126.20&lt;/code&gt; (Norton)&lt;/td&gt;
&lt;td&gt;203.116.50.51:443&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;66ms&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;43ms&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;105ms&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;43ms&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;46ms&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;303ms&lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
&lt;td&gt;&lt;code&gt;1.1.1.1&lt;/code&gt; (Cloudflare)&lt;/td&gt;
&lt;td&gt;&lt;strong&gt;184.86.250.8:443&lt;/strong&gt;&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;36ms&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;67ms&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;144ms&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;66ms&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;110ms&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;&lt;strong&gt;423ms&lt;/strong&gt;&lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
&lt;td&gt;&lt;code&gt;180.76.76.76&lt;/code&gt; (Baidu)&lt;/td&gt;
&lt;td&gt;23.2.16.32:443&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;72ms&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;84ms&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;181ms&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;84ms&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;114ms&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;535ms&lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
&lt;td&gt;&lt;code&gt;119.29.29.29&lt;/code&gt; (DNSPod)&lt;/td&gt;
&lt;td&gt;23.42.156.42:443&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;70ms&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;90ms&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;187ms&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;90ms&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;103ms&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;542ms&lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
&lt;td&gt;&lt;code&gt;8.26.56.26&lt;/code&gt; (Comodo)&lt;/td&gt;
&lt;td&gt;104.86.110.185:443&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;225ms&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;220ms&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;442ms&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;221ms&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;312ms&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;1.421s&lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
&lt;td&gt;&lt;code&gt;185.228.168.168&lt;/code&gt; (Clean Browsing)&lt;/td&gt;
&lt;td&gt;80.239.137.26:443&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;212ms&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;225ms&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;464ms&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;229ms&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;507ms&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;1.636s&lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
&lt;td&gt;&lt;code&gt;114.114.114.114&lt;/code&gt; (114dns)&lt;/td&gt;
&lt;td&gt;23.215.104.225:443&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;264ms&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;259ms&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;527ms&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;260ms&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;610ms&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;1.92s&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;

&lt;p&gt;In this case only Google, OpenDNS and ISP resolvers send me to an ISP-local POP. Quad9 came #2 because of their fast DNS time (this test does not use locally cached DNS).&lt;/p&gt;

&lt;p&gt;Cloudflare sends me to Singapore, and others further out.&lt;/p&gt;

&lt;p&gt;Cloudflare sending me Singapore IP might be due to the fact that for me &lt;code&gt;1.1.1.1&lt;/code&gt; is being routed to Cloudflare Singapore, probably True&amp;rsquo;s fault.&lt;/p&gt;

&lt;pre style=&#34;overflow-x:scroll;font-size:12px;white-space:pre&#34;&gt;
~# mtr --report-wide 1.1.1.1
Start: Sat Apr 21 21:05:43 2018
HOST: apu                                       Loss%   Snt   Last   Avg  Best  Wrst StDev
  1.|-- 192.168.2.1                                0.0%    10    1.2   1.1   0.9   1.2   0.0
  2.|-- 10.137.128.1                               0.0%    10   18.0  13.4  10.5  18.8   2.8
  3.|-- 10.246.253.133                             0.0%    10    8.8   8.3   6.3   9.7   0.9
  4.|-- 10.185.94.203                              0.0%    10    8.2   9.3   7.8  11.7   1.3
  5.|-- 10.185.94.25                               0.0%    10    9.2   9.4   7.5  15.1   2.1
  6.|-- 61-91-220-101.static.asianet.co.th         0.0%    10    8.3   9.2   7.8  10.2   0.5
  7.|-- 58-97-82-116.static.asianet.co.th          0.0%    10    8.6  10.2   8.5  13.4   1.4
  8.|-- ppp-171-102-254-65.revip18.asianet.co.th   0.0%    10    9.2   9.7   8.3  11.4   0.7
  9.|-- ppp-171-102-254-227.revip18.asianet.co.th  0.0%    10   11.5  10.6   8.9  15.9   2.0
 10.|-- 210-86-143-74.static.asianet.co.th         0.0%    10    9.8   9.3   8.0  10.8   0.7
 11.|-- TIG-Net242-108.trueintergateway.com        0.0%    10   10.6  11.8   9.8  16.5   1.9
 12.|-- TIG-Net245-241.trueintergateway.com        0.0%    10   39.7  40.5  38.5  47.6   2.5
 13.|-- 13335.sgw.equinix.com                      0.0%    10   41.8  38.2  36.5  44.5   2.6
 14.|-- 1dot1dot1dot1.cloudflare-dns.com           0.0%    10   35.3  37.4  35.3  40.0   1.2
&lt;/pre&gt;

&lt;p&gt;Dear Cloudflare, please turn on ECS by default.&lt;/p&gt;

&lt;p&gt;PS: Check out &lt;a href=&#34;https://ismydnsfast.com/&#34;&gt;ismydnsfast.com&lt;/a&gt; to check &lt;em&gt;your&lt;/em&gt; performance to major authoritative DNS providers.&lt;/p&gt;
</description>
    </item>
    
    <item>
      <title>DFP now officially supports asynchronous rendering!</title>
      <link>https://www.sajalkayan.com/dfp-now-officially-supports-asynchronous-rendering.html</link>
      <pubDate>Thu, 27 Oct 2011 12:29:52 +0000</pubDate>
      
      <guid>https://www.sajalkayan.com/dfp-now-officially-supports-asynchronous-rendering.html</guid>
      <description>Yesterday, DFP launched &lt;a href=&#34;http://www.google.com/support/dfp_sb/bin/answer.py?hl=en&amp;answer=181071&#34;&gt;asynchronous ad loading&lt;/a&gt;. For the past few months ive &lt;a href=&#34;https://www.sajalkayan.com/optimizing-dfp-performance.html&#34; title=&#34;Optimizing DFP performance&#34;&gt;been&lt;/a&gt; &lt;a href=&#34;https://www.sajalkayan.com/complete-asynchronous-ad-loading-using-dfp-and-labjs.html&#34; title=&#34;Complete Asynchronous ad loading using DFP and LABjs&#34;&gt;trying&lt;/a&gt; to load ads in a manner where it doesn&#39;t affect rest of the page load, this new development is like a dream come true.

&lt;iframe width=&#34;480&#34; height=&#34;244&#34; src=&#34;http://www.youtube.com/embed/bA-Qgl7JqlQ&#34; frameborder=&#34;0&#34; allowfullscreen&gt;&lt;/iframe&gt;
(The tests above were run on &lt;a href=&#34;http://www.webpagetest.org/&#34;&gt;webpagetest.org&lt;/a&gt; on IE8 at Dulles, VA)

Thank you Google! You just made my day.
</description>
    </item>
    
    <item>
      <title>Evaluating few CDN options</title>
      <link>https://www.sajalkayan.com/evaluating-few-cdn-options.html</link>
      <pubDate>Fri, 10 Jun 2011 21:10:53 +0000</pubDate>
      
      <guid>https://www.sajalkayan.com/evaluating-few-cdn-options.html</guid>
      <description>Recently, I was evaluating CDN options for a client with some unique challenges. We ended up using Amazon CloudFront, but ill detail the options we looked at and what let us to this decision.

Some things to note:-
&lt;ul&gt;
	&lt;li&gt;We would serve CSS, JS, Images referred to from stylesheets and some website images thru the CDN.&lt;/li&gt;
	&lt;li&gt;Due to the nature(trust me) of the site we expect a higher than normal miss rate. The access is spread across a wide number of urls, some may get lower hits.&lt;/li&gt;
	&lt;li&gt;Speed is important. Website should be fast(er) from everywhere. The most important regions in order of priority are US, EU, AU and ROTW with US being most important.&lt;/li&gt;
	&lt;li&gt;Anything on the site can change anytime, there is no build process as such. Any object anywhere can change, and change must be visible ASAP.&lt;/li&gt;
	&lt;li&gt;Developers/designers shouldn&#39;t be harassed to purge a file if they change something.&lt;/li&gt;
	&lt;li&gt;CDN data usage : ~100 GB per month&lt;/li&gt;
&lt;/ul&gt;

The providers we looked at :-

&lt;strong&gt;&lt;a href=&#34;http://www.maxcdn.com/features/network&#34;&gt;MaxCDN&lt;/a&gt;: Almost sealed the deal.&lt;/strong&gt;

Pros:-
&lt;ul&gt;
	&lt;li&gt;Cheap : $40 for first TB (must use in a year) + $99 per additional TB . On current usage rates this comes to say 0.04+ /GB.&lt;/li&gt;
	&lt;li&gt;* Anycast/BGP routing : No way bad &lt;a href=&#34;https://www.sajalkayan.com/in-a-cdnd-world-opendns-is-the-enemy.html&#34;&gt;DNS server can mess up&lt;/a&gt; routing.&lt;/li&gt;
	&lt;li&gt;Nice control panel, has a purge all option for just in case. Purges take effect almost instantly.&lt;/li&gt;
	&lt;li&gt;Handles gzip well.&lt;/li&gt;
	&lt;li&gt;Can have separate cache timings for caching in Browser and caching at CDN. - i.e. We can say not cache a file in browser level, but cache at CDN and purge when theres a change made.&lt;/li&gt;
&lt;/ul&gt;

Cons:-
&lt;ul&gt;
	&lt;li&gt;&lt;strong&gt;&lt;a href=&#34;http://www.maxcdn.com/features/network&#34;&gt;Poor global coverage&lt;/a&gt;. - No POP/Edge in Asia/AU - Deal Breaker&lt;/strong&gt;&lt;/li&gt;
	&lt;li&gt;Pages loaded same speed when testing from AU with or without CDN.&lt;/li&gt;
&lt;/ul&gt;

&lt;strong&gt;&lt;a href=&#34;http://www.edgecast.com/&#34;&gt;EdgeCast&lt;/a&gt;: Looked good at first, but poor gziping.&lt;/strong&gt;

Pros:-
&lt;ul&gt;
	&lt;li&gt;Impressive list of networks&lt;/li&gt;
	&lt;li&gt;Highly configurable control panel.&lt;/li&gt;
	&lt;li&gt;Can have separate cache timings for caching in Browser and caching at CDN. - i.e. We can say not cache a file in browser level, but cache at CDN and purge when theres a change made.&lt;/li&gt;
&lt;/ul&gt;

Cons:-
&lt;ul&gt;
	&lt;li&gt;&lt;strong&gt;Gzippable files will not be gzipped for cache misses. - Deal Breaker&lt;/strong&gt;&lt;/li&gt;
	&lt;li&gt;Request from Edge server to origin is uncompressed.&lt;/li&gt;
	&lt;li&gt;Expensive and wants higher commitments.&lt;/li&gt;
	&lt;li&gt;DNS Based routing&lt;/li&gt;
&lt;/ul&gt;

&lt;strong&gt;&lt;a href=&#34;http://www.us.cdnetworks.com/&#34;&gt;CDNetworks&lt;/a&gt;: Didn&#39;t look past price&lt;/strong&gt;

Cons:-
&lt;ul&gt;
	&lt;li&gt;&lt;strong&gt;Ridiculously high price - Dealbreaker&lt;/strong&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;strong&gt;&lt;a href=&#34;http://aws.amazon.com/cloudfront/&#34;&gt;Amazon CloudFront&lt;/a&gt;: WIN&lt;/strong&gt;

Pros:-
&lt;ul&gt;
	&lt;li&gt;&lt;strong&gt;Testing showed our pages to be fastest from all regions when using cloudfront&lt;/strong&gt;. YMMV&lt;/li&gt;
	&lt;li&gt;No commitments - $0.15 - $0.2/GB (depends on where user accesses from) + negligible per request fee&lt;/li&gt;
	&lt;li&gt;Client is already AWS user, one less account to maintain.&lt;/li&gt;
	&lt;li&gt;No need to send gazillion emails to gazillions of people to get started. No bargaining.&lt;/li&gt;
&lt;/ul&gt;



Cons:-
&lt;ul&gt;
	&lt;li&gt;No POP/Edge in AU (but has in Singapore, Hong Kong and Tokyo)&lt;/li&gt;
	&lt;li&gt;DNS based routing.&lt;/li&gt;
	&lt;li&gt;Charges fee per request and per invalidation(purge) request.&lt;/li&gt;
	&lt;li&gt;No control panel, invalidation requests need to be done by API only.&lt;/li&gt;
	&lt;li&gt;Does not do gzipping, but honours Vary header and serves correct version based on what user asks.&lt;/li&gt;
	&lt;li&gt;Can&#39;t use querystring parameters for CDN cachebusting. CloudFront ignores querystrings.&lt;/li&gt;
&lt;/ul&gt;



Sidenote : Requests from CloudFront to origin are HTTP 1.0 . Nginx by default does not serve gzip to 1.0 request. &lt;a href=&#34;http://wiki.nginx.org/HttpGzipModule#gzip_http_version&#34;&gt;gzip_http_version&lt;/a&gt;  setting must be changed in order to use nginx as origin for CloudFront.


The system we architected adds something based on the file mtime as a part of the URL, so now we don&#39;t need to any purges at the CDN. Also now we can have far future expires on all CDN&#39;d objects cause if something changes, the URL would automagically change.

For us, the price and features are important, but whats more important is the results. We went with the provider with lesser features just because our pages loaded fastest with them.
</description>
    </item>
    
    <item>
      <title>Attention skeptics: Web Performance Optimization works!</title>
      <link>https://www.sajalkayan.com/attention-skeptics-web-performance-optimization-works.html</link>
      <pubDate>Sat, 14 May 2011 14:39:14 +0000</pubDate>
      
      <guid>https://www.sajalkayan.com/attention-skeptics-web-performance-optimization-works.html</guid>
      <description>Today, I was looking into web performance issues for a new client who wishes to remain anonymous and saw an interesting example of value provided by improving performance.

One of the first things I do when looking into a new site is look at Google Analytics to understand a little about the sites visitors. This helps in prioritizing changes which affects the majority of users.

An interesting observation :-

&lt;strong&gt;Pageviews for all visitors&lt;/strong&gt;
&lt;a href=&#34;http://i.ticdn.com/sajal/page-views.png&#34; target=&#34;_blank&#34; title=&#34;Pageviews for all visitors&#34;&gt;&lt;img src=&#34;http://i.ticdn.com/sajal/page-views-s.png&#34; alt=&#34;Pageviews for all visitors&#34; /&gt;&lt;/a&gt;

&lt;strong&gt;Average Pageviews for all visitors&lt;/strong&gt;
&lt;a href=&#34;http://i.ticdn.com/sajal/avg-page-views.png&#34; target=&#34;_blank&#34; title=&#34;Average Pageviews for all visitors&#34;&gt;&lt;img src=&#34;http://i.ticdn.com/sajal/avg-page-views-s.png&#34; alt=&#34;Average Pageviews for all visitors&#34; /&gt;&lt;/a&gt;

Adsense revenue also followed a similar path. -- Screenshot not available

The reason for this effect was a simple database indexing tweak which sped up the backend performance of a very important action page on the site.

The site in question is a web application where user inputs something and gets some result. It is not a content site where pageview/user could have increased due to some interesting content being added or something. The only change was indexing of a column which should have an index right from the start.

&lt;em&gt;DISCLAIMER: I did not have any role in the above improvement. This was done before my involvement. Perhaps this convinced the client to hire me. Screenshots/info shared with clients permission.&lt;/em&gt;
</description>
    </item>
    
    <item>
      <title>Dear Google: W-W-W-WHY Y-YOU DO DAT?</title>
      <link>https://www.sajalkayan.com/dear-google-w-w-w-why-y-you-do-dat.html</link>
      <pubDate>Sat, 12 Mar 2011 19:01:28 +0000</pubDate>
      
      <guid>https://www.sajalkayan.com/dear-google-w-w-w-why-y-you-do-dat.html</guid>
      <description>&lt;img src=&#34;http://i.ticdn.com/sajal/documentwrite-W-W-W-WHY-Y-YOU-DO-DAT.jpg&#34; alt=&#34;document.write() .. why?&#34; /&gt;
</description>
    </item>
    
    <item>
      <title>Complete Asynchronous ad loading using DFP and LABjs</title>
      <link>https://www.sajalkayan.com/complete-asynchronous-ad-loading-using-dfp-and-labjs.html</link>
      <pubDate>Wed, 02 Mar 2011 18:43:51 +0000</pubDate>
      
      <guid>https://www.sajalkayan.com/complete-asynchronous-ad-loading-using-dfp-and-labjs.html</guid>
      <description>UPDATE: The hack is now available on &lt;a href=&#34;https://github.com/sajal/async-DFP-ads&#34;&gt;GitHub&lt;/a&gt;.

&lt;strong&gt;8th May 2011: This seems to be having problems, will investigate and update when i have time. Pls revert to normal DFP tags for now.&lt;/strong&gt;

One of the biggest challenges when optimizing performance of websites is third party content - specifically advertisements.

Most ad networks and servers use evil document.write() in their JavaScript(and even nested document.writes) which block further rendering of the page until their code has completed execution. In this blogpost, I&#39;ll show how you can use &lt;a href=&#34;http://www.google.com/support/dfp_sb/bin/answer.py?hl=en&amp;answer=90777&#34;&gt;DFP&#39;s iframe tagging&lt;/a&gt;(read warnings there) combined with &lt;a href=&#34;http://labjs.com/&#34; title=&#34;Loading And Blocking JavaScript&#34;&gt;LABjs&lt;/a&gt; and little bit of JavaScript hackery to make any ad load asynchronously with negligible impact on rest of the pageload.

Attention Deficit Disorder version : &lt;a href=&#34;https://www.sajalkayan.com/tests/dfp-iframe-tagging.html&#34; target=&#34;_blank&#34;&gt;Before&lt;/a&gt; - &lt;a href=&#34;https://www.sajalkayan.com/tests/dfp-async-LABjs.html&#34; target=&#34;_blank&#34;&gt;After&lt;/a&gt;

NOTE: Use the method below entirely at your own risk! Use only if you know what you are doing...

&lt;h3&gt;Current blocking method&lt;/h3&gt;

DFP has an experimental method to load ads called iframe tagging. The JS looks like this :-

The Bootstrap: In &amp;lt;head&amp;gt; (Does not have to be in &amp;lt;head&amp;gt; but before the first &lt;em&gt;GA_googleFillSlotWithSize&lt;/em&gt; call) :-
&lt;pre style=&#34;width:500;overflow-x:scroll;&#34;&gt;
&amp;lt;script type=&#39;text/javascript&#39; src=&#39;http://partner.googleadservices.com/gampad/google_service.js&#39;&amp;gt;
&amp;lt;/script&amp;gt;
&amp;lt;script type=&#39;text/javascript&#39;&amp;gt;
GS_googleAddAdSenseService(&#34;ca-pub-7046344781760701&#34;);
GS_googleEnableAllServices();
&amp;lt;/script&amp;gt;
&amp;lt;script type=&#39;text/javascript&#39;&amp;gt;
GA_googleUseIframeRendering();
&amp;lt;/script&amp;gt;
&lt;/pre&gt;

Then wherever we want the ads to display, we put something like this :-

&lt;pre style=&#34;width:500;overflow-x:scroll;&#34;&gt;
&amp;lt;script type=&#39;text/javascript&#39;&amp;gt;
GA_googleFillSlotWithSize(&#34;ca-pub-7046344781760701&#34;, &#34;test_async_lb&#34;, 728, 90);
&amp;lt;/script&amp;gt;
&lt;/pre&gt;

With this method, the bootstrap does some blocking. First it loads a JavaScript then the following functions document.write another &amp;lt;script&amp;gt; tag which must load sequentially again. The &lt;em&gt;GA_googleFillSlotWithSize&lt;/em&gt; function is relatively inexpensive. All it seems to do is document.write an iframe with various targeting information as parameters in the URL and does not block further rendering. The advantage of iframe tagging is that slow ad networks don&#39;t fuck up your page. But the bootstrap is very expensive as shown in this waterfall chart.

&lt;a href=&#34;https://www.sajalkayan.com/tests/dfp-iframe-tagging.html&#34; target=&#34;_blank&#34;&gt;This&lt;/a&gt; is what it looks like.

&lt;img src=&#34;http://i.ticdn.com/sajal/dfp-async/normal.png&#34; alt=&#34;normal DFP iframe bootstrap&#34; title=&#34;normal DFP iframe bootstrap&#34; height=&#34;186&#34; width=&#34;485&#34; /&gt;

&lt;h3&gt;The hack&lt;/h3&gt;

Last few days, I&#39;ve been playing a little with &lt;a href=&#34;http://labjs.com/&#34; title=&#34;Loading And Blocking JavaScript&#34;&gt;LABjs&lt;/a&gt;, specifically its &lt;a href=&#34;http://gist.github.com/603980&#34; title=&#34;Snippet to load LABjs itself dynamically&#34;&gt;complete async loader&lt;/a&gt;.

After playing with LABjs, ive come up with the following LABjs snippet :-

&lt;pre style=&#34;width:500;overflow-x:scroll;&#34;&gt;
      // intercepts the script inserted via document.write and loads it via LABjs
      function docwrt(str){
        var script = str.replace(/(.*)\=\&#34;/g, &#39;&#39;).replace(/\&#34;(.*)/g, &#39;&#39;);
        $LAB.script(script).wait(function(){
          GA_googleUseIframeRendering();
          // following function makes the magic happen!
          function Wrapper_googleFillSlotWithSize(pubid, slotname, width, height, target){
            var docwrttemp = function(str){
              target = document.getElementById(target);
              target.innerHTML = str;
            };  
            document.write = docwrttemp;
            GA_googleFillSlotWithSize(pubid, slotname, width, height);
          }
          // usage of the new wrapper here &#34;leaderboard&#34; and &#34;skyscraper&#34; are target div ids
          Wrapper_googleFillSlotWithSize(&#34;ca-pub-7046344781760701&#34;, &#34;test_async_lb&#34;, 728, 90, &#34;leaderboard&#34;);
          Wrapper_googleFillSlotWithSize(&#34;ca-pub-7046344781760701&#34;, &#34;test_async_sky&#34;, 160, 600, &#34;skyscraper&#34;);
        });
      }

      document.write = docwrt; //intercepts document.write from below script
      $LAB.script(&#34;http://partner.googleadservices.com/gampad/google_service.js&#34;).wait(function(){
        GS_googleAddAdSenseService(&#34;ca-pub-7046344781760701&#34;);
        GS_googleEnableAllServices();
      });

&lt;/pre&gt;

(note: Since I&#39;m lazy, I haven&#39;t restored &lt;em&gt;document.write&lt;/em&gt; back to its original glory.)

Here &lt;em&gt;Wrapper_googleFillSlotWithSize&lt;/em&gt; is a wrapper around &lt;em&gt;GA_googleFillSlotWithSize&lt;/em&gt; which takes a 5th argument - &lt;em&gt;target&lt;/em&gt; - This is the id of &amp;lt;div&amp;gt; where we want to show the ad.

&lt;a href=&#34;https://www.sajalkayan.com/tests/dfp-async-LABjs.html&#34; target=&#34;_blank&#34;&gt;Here&lt;/a&gt; is a sample page using this hack. Id appreciate it if I get some feedback about this method via comments below. As I said earlier, use your own better judgment before using this snippet in production. I welcome criticism but will not accept blame if this doesn&#39;t work for you. 

In my simple example, it may seem it takes longer to fully load the page, but if you have many other things on the page, the overall effect will be better with this hack. Moreover, if you are already using LABjs on your site, this is a no-brainer. With this method, even if Google is inaccessible(for whatever reasons) it wont &lt;a href=&#34;http://www.stevesouders.com/blog/2010/06/01/frontend-spof/&#34;&gt;SPOF&lt;/a&gt; your page.

&lt;a href=&#34;http://i.ticdn.com/sajal/dfp-async/video.mp4&#34;&gt;Slow motion video&lt;/a&gt; of pageloads on IE8:-

&lt;iframe title=&#34;YouTube video player&#34; width=&#34;500&#34; height=&#34;311&#34; src=&#34;http://www.youtube.com/embed/Vz2unMmBN_8&#34; frameborder=&#34;0&#34; allowfullscreen&gt;&lt;/iframe&gt;
Generated via &lt;a href=&#34;http://www.webpagetest.org/&#34;&gt;webpagetest.org&lt;/a&gt;

Left is normal method, right is hacked version.

Currently tested on IE(7 thru 9), Firefox 3.6.11, Chrome 10.0.648.45 dev and an unknown version of Safari.

&lt;h3&gt;Conclusions...&lt;/h3&gt;

The world would be a much better place without the evil document.write(). Google should know better. They should make a function like &lt;em&gt;Wrapper_googleFillSlotWithSize&lt;/em&gt; by default.
</description>
    </item>
    
    <item>
      <title>Internet connectivity in Myanmar (Burma)</title>
      <link>https://www.sajalkayan.com/internet-connectivity-in-myanmar-burma.html</link>
      <pubDate>Mon, 21 Feb 2011 09:21:09 +0000</pubDate>
      
      <guid>https://www.sajalkayan.com/internet-connectivity-in-myanmar-burma.html</guid>
      <description>Last weekend ( Feb 19th &amp; 20th) I was in Yangon for &lt;a href=&#34;http://www.barcampyangon.org/&#34;&gt;BarCamp Yangon&lt;/a&gt;.

It probably had an attendance of &amp;gt; 4k participants... Probably one of the largest BarCamps ever,  despite the fact that the internet connectivity in Myanmar sucks big time.... Really unusable... 

I used internet at the free &#34;wifi&#34; internet at the hotel and the wifi arranged by the organizers. Both places, the speeds I&#39;ve seen range from 0 kbps to ~50 kbps.... most of the time around 0 kbps :P

&lt;h3&gt;Internet access&lt;/h3&gt;

Most locals use internet at cafes/internet shops. The average shop would have 512 kbps connection shared between 15 to 20 computers charging 300 to 500 MKY ( US$ 0.3 to 0.5 ) per hour for usage. Some give discount if you bring your own laptop, some don&#39;t. I didn&#39;t get a chance to visit a cafe, this is based on what people told me.

Most geeks have a computer at home, very few have laptops. ADSL is available but is very expensive. It costs &gt; $1000 setup fee + $120/month for a mere 512 kbps. Only the very rich people can afford it.

Mobile internet was unheard of until few weeks ago. They don&#39;t have gprs there, but recently they launched 3G and CDMA for wireless internet. CDMA would charge around $0.10/minute for 1 or 2 mbps (don&#39;t remember clearly).

Out of the few sites i tried opening, only Facebook seemed to be usable. This is due to the &lt;a href=&#34;http://www.youtube.com/watch?v=51JGykHrwZA&#34; title=&#34;David Wei and Changhao Jiang (Facebook Inc.) - Frontend Performance Engineering in Facebook&#34;&gt;enormous effort&lt;/a&gt; they invest in &lt;a href=&#34;https://www.sajalkayan.com/tag/site-performance&#34;&gt;frontend performance&lt;/a&gt;. Google search was also fast, but none of the sites in the results seemed to open.

The average DNS query took me 2+ seconds to resolve. DNS access is limited to the ISPs crappy nameserver, I couldn&#39;t use opendns or any external nameservers.

Almost all local sites are hosted outside of Myanmar cause domestic connectivity is as bad as international routes. Server co-location fees are 10x in Burma than in America.

&lt;h3&gt;Censorship&lt;/h3&gt;

I didn&#39;t use the internet much... but here is what I found.

Among the sites/services blocked :-

&lt;ul&gt;
&lt;li&gt;My secret project - Details/screenshot below&lt;/li&gt;
&lt;li&gt;Twitter - Blocked normally, but works using https or apps.&lt;/li&gt;
&lt;li&gt;Gmail - works on browser but IMAP doesn&#39;t work at all... The most surprising aspect of it is that 99% of ppl there use gmail.&lt;/li&gt;
&lt;li&gt;SSH - connections to port 22 are completely blocked, but I&#39;ve been told that setting ssh server on port 443 works fine. I used &lt;a href=&#34;http://www.splitbrain.org/blog/2008-11/02-dns_tunneling_made_simple&#34;&gt;DNS tunnel&lt;/a&gt; and it kinda worked occasionally for emergency usage - after trying for 10 - 15 mins i could get 1 min or so of connectivity.&lt;/li&gt;
&lt;li&gt;gtalk - Using Pidgin  - doesn&#39;t work at all.&lt;/li&gt;
&lt;/ul&gt;

I am building a new webservice called www.{secret}.com . Hardly anyone knows about it. Its got only 3 users, and has nothing to do with Burma. That site was somehow blocked in Burma (only one ISP). I cant understand how {secret} could trigger any phrase based blocklists or something.. Makes me feel important if governments block my site...

My moment of pride :-

&lt;a href=&#34;http://i.ticdn.com/sajal/blocked-classified-big.png&#34; title=&#34;secret project blocked in burma&#34;&gt;&lt;img src=&#34;http://i.ticdn.com/sajal/blocked-classified-small.png&#34; alt=&#34;secret project blocked in burma&#34; /&gt;&lt;/a&gt;

&lt;h3&gt;Summary&lt;/h3&gt;

BarCamp Yangoon 2011 was probably the biggest barcamp ever with about 4500 to 5000 participants (with about 20 - 30 foreigners traveling in from abroad). An interesting activity was file swapping. There were about 20 - 30 computers setup with shared folders which participants used to exchange software/music/etc. 

Based on a simple survey, everyone uses Firefox. Very few people use Linux. Windows is very popular due to rampant piracy.

I was considering giving a talk on web performance optimization on day 2 of the event, but didn&#39;t go thru with it cause an American expat covered the topic well on day 1.

One thing that I should have done would be to download all the &lt;a href=&#34;http://velocityconf.com/&#34;&gt;Velocity Conference&lt;/a&gt; videos and pass it around... unfortunately it occurred to me to late. Ill try to arrange it now...

The country has great people... It can succeed in this digital age if only America and other western countries lift sanctions on Burma..
</description>
    </item>
    
    <item>
      <title>Whos.amung.us goes down taking out numerous client websites</title>
      <link>https://www.sajalkayan.com/whosamungus-goes-down-taking-out-numerous-client-websites.html</link>
      <pubDate>Sun, 12 Sep 2010 17:04:54 +0000</pubDate>
      
      <guid>https://www.sajalkayan.com/whosamungus-goes-down-taking-out-numerous-client-websites.html</guid>
      <description>Realtime web analytics service &lt;a href=&#34;http://whos.amung.us/&#34;&gt;whos.amung.us&lt;/a&gt; has been completely down for at least the last 3 hours (as of sept 12 4:28pm UTC). Thousands of webmasters (myself included) use this widget to gather realtime traffic stats for websites. The current outage has caused big problems to the sites implementing this widget.

Lets look at their widget implementation.

&lt;code lang=&#34;html&#34;&gt;
&amp;lt;script type=&#34;text/javascript&#34; src=&#34;http://widgets.amung.us/small.js&#34;&amp;gt;&amp;lt;/script&amp;gt;&amp;lt;script type=&#34;text/javascript&#34;&amp;gt;WAU_small(&#39;unique-site-tag&#39;)&amp;lt;/script&amp;gt;
&lt;/code&gt;
This is bad!

The base javascript uses document.write, hence cant be made to load asynchronously. Moreover, they write an &lt;em&gt;img&lt;/em&gt; tag into the document which too must be be loaded before the window.onload event can be triggered.

This incident was somehow not critical FAIL for me cause I am aware about &lt;a href=&#34;http://www.stevesouders.com/blog/2010/06/01/frontend-spof/&#34;&gt;frontend SPOF&lt;/a&gt; issues and placed this widget just before &amp;lt;/body&amp;gt;, so it didn&#39;t completely mess with my page, but still caused the following problems.
&lt;ol&gt;
	&lt;li&gt;Delayed the window.onload event, delaying executing of other scripts made to run after onload.&lt;/li&gt;
	&lt;li&gt;Showed &#34;waiting for .... &#34; in the status bar of the browsers for a long time before timing out, indicating to the user that the page is still not ready.&lt;/li&gt;
	&lt;li&gt;Makes Google think your site is really slow and doesn&#39;t deserve to rank!&lt;/li&gt;&lt;/ol&gt;

Now, for webmasters not aware about these issues the problems is possibly critical. In case the widget code is &lt;strong&gt;before&lt;/strong&gt; the main content of their site, they are in for a hard time. Their site would stop loading at the point the widget is located in the html, giving the users an impression that the website is &lt;em&gt;broken&lt;/em&gt;.

I understand that today is a Sunday, and not all the engineers/OPs can be on standby 100% of the time to fix these issues. Downtime is inevitable, but when you FAIL, don&#39;t take your customers/users down with you. Their javascript serving server was still more stable than the server. &lt;a href=&#34;http://www.webpagetest.org/result/100912_7b6ecd8e647bd261a200da177953de1a/1/details/&#34;&gt;Here is a Webpagetest.org result for my site&lt;/a&gt; during the outage. Its the dynamic counter image which SPOF&#39;d.

If they must use document.write, write a div, give it a name, and attach the image into it using dom manipulation &lt;strong&gt;after the window.onload&lt;/strong&gt;.

Moreover, when the servers come under high load, there should be a mechanism to FAIL early with an appropriate status code.

Respect your users, don&#39;t take them for granted!

&lt;em&gt;Disclaimer: My current secret project is somewhat related to real-time analytics.&lt;/em&gt;
</description>
    </item>
    
    <item>
      <title>Optimizing DFP performance</title>
      <link>https://www.sajalkayan.com/optimizing-dfp-performance.html</link>
      <pubDate>Fri, 10 Sep 2010 18:09:35 +0000</pubDate>
      
      <guid>https://www.sajalkayan.com/optimizing-dfp-performance.html</guid>
      <description>Ive been using &lt;a href=&#34;https://www.google.com/dfp/&#34;&gt;DFP&lt;/a&gt; (DoubleClick for Publishers - formerly Google Ad Manager) to serve ads as it has some certain features I really need.

The downside of using DFP is that its browser side performance sucks big time. On my site, I use the experimental Iframe tagging, which basically writes an iframe in place of the ad and loads the third party ad codes into it. This runs asynchronously and is nice, but the DFP&#39;s bootstrap javascript blocks rendering and it needs to load 3 javascript files from Google serially. This bootstrap must be available before trying to fill an ad slot.

&lt;h3&gt;The Goal&lt;/h3&gt;

Show the story title and body to the user As Soon As Possible

&lt;h3&gt;The Problem&lt;/h3&gt;

The instructions of implementing the Iframe tagging is as such.

In the &amp;lt;head&amp;gt;...&amp;lt;/head&amp;gt; section :-

&lt;code lang=&#34;html&#34;&gt;
&amp;lt;!-- PUT THIS TAG IN THE head SECTION --&amp;gt;
&amp;lt;script src=&#34;http://partner.googleadservices.com/gampad/google_service.js&#34; type=&#34;text/javascript&#34;&amp;gt;&amp;lt;/script&amp;gt;
&amp;lt;script type=&#34;text/javascript&#34;&amp;gt;
GS_googleAddAdSenseService(&#34;ca-pub-xxxxxxxxxxxxxxxx&#34;); 
GS_googleEnableAllServices();
&amp;lt;/script&amp;gt;
&amp;lt;script type=&#34;text/javascript&#34;&amp;gt;
GA_googleUseIframeRendering();
&amp;lt;/script&amp;gt;
&amp;lt;!-- END OF TAG FOR head SECTION --&amp;gt;
&lt;/code&gt;

And where the ad slot needs to be displayed always in the &amp;lt;body&amp;gt;...&amp;lt;/body&amp;gt;:-

&lt;code lang=&#34;html&#34;&gt;
&amp;lt;script type=&#34;text/javascript&#34;&amp;gt;
GA_googleFillSlotWithSize(&#34;ca-pub-xxxxxxxxxxxxxxxx&#34;, &#34;slot_name&#34;, 728, 90);
&amp;lt;/script&amp;gt;
&lt;/code&gt;

The resulting waterfall chart of this method :-

&lt;img src=&#34;http://i.ticdn.com/sajal/dfp-before.png&#34; alt=&#34;DFP before&#34; height=&#34;240&#34; width=&#34;404&#34; /&gt;

Requests #3, #4 and #5 is the bootstrap for DFP. The green line indicates the first paint event.

It is clear that 
&lt;ol&gt;
	&lt;li&gt;The browser needs to make 3 sequential requests&lt;/li&gt;
	&lt;li&gt;Until these 3 javascripts are downloaded and parsed, the rendering cannot begin. - The user is affectively staring at a blank screen.&lt;/li&gt;
	&lt;li&gt;The browser is doing nothing else while downloading these files.&lt;/li&gt;
&lt;/ol&gt;

&lt;h3&gt;The Workaround&lt;/h3&gt;

I was going to mark this section as a &#34;solution&#34; to the problem... but it isint. The page is still susceptible to &lt;a href=&#34;http://www.stevesouders.com/blog/2010/06/01/frontend-spof/&#34;&gt;frontend SPOF&lt;/a&gt; .. That is if the servers hosting the DFP JavaScripts is unaccessible, that calls for a terrible user experience on my site.

What I did was simply moved the bootstrap to just before the first time the &lt;em&gt;GA_googleFillSlotWithSize()&lt;/em&gt; function was called. i.e. move the bootstrap from the &amp;lt;head&amp;gt; to the &amp;lt;body&amp;gt; part of the page.

The waterfall chart for this is :-

&lt;img src=&#34;http://i.ticdn.com/sajal/dfp-after.png&#34; alt=&#34;DFP after&#34; height=&#34;223&#34; width=&#34;472&#34; /&gt;

Requests #3, #7 and #8 is the bootstrap for DFP. The green line indicates the first paint event.

It is clear that 
&lt;ol&gt;
	&lt;li&gt;The browser still needs to make 3 sequential requests&lt;/li&gt;
	&lt;li&gt;While the bootstrap was loading, the user can see the header of the site, providing visual feedback that something is happening. - The &lt;em&gt;start render&lt;/em&gt; did not have to wait.&lt;/li&gt;
	&lt;li&gt;The browser is downloading images, etc referred to earlier while downloading the bootstrap.&lt;/li&gt;
	&lt;li&gt;There is 200ms improvement in the time at which the user can start reading the story.&lt;/li&gt;
&lt;/ol&gt;

Here is a video comparing the 2 loading methods :-

&lt;object width=&#34;480&#34; height=&#34;295&#34;&gt;&lt;param name=&#34;movie&#34; value=&#34;http://www.youtube.com/v/YF9-Us8xAVM?fs=1&amp;amp;hl=en_US&#34;&gt;&lt;/param&gt;&lt;param name=&#34;allowFullScreen&#34; value=&#34;true&#34;&gt;&lt;/param&gt;&lt;param name=&#34;allowscriptaccess&#34; value=&#34;always&#34;&gt;&lt;/param&gt;&lt;embed src=&#34;http://www.youtube.com/v/YF9-Us8xAVM?fs=1&amp;amp;hl=en_US&#34; type=&#34;application/x-shockwave-flash&#34; allowscriptaccess=&#34;always&#34; allowfullscreen=&#34;true&#34; width=&#34;480&#34; height=&#34;295&#34;&gt;&lt;/embed&gt;&lt;/object&gt;

If anyone has better ways to embed DFP, please let me know via comments below.

&lt;h3&gt;The Solutions&lt;/h3&gt;

There are 2 ways to solve this
&lt;ul&gt;
	&lt;li&gt;Have source ordered HTML where the adcodes are always after the content in the HTML source of the page. This ensures that the user can start reading while DFP does its blocking thing. - A site redesign is in planning and that would implement this step.&lt;/li&gt;
	&lt;li&gt;DFP changes the way it works... by replacing the evil document.write with DOM manipulation techniques so the scripts can be loaded asynchronously.&lt;/li&gt;
&lt;/ul&gt;

So next time if a third party script provider tells you that certain code &lt;strong&gt;must&lt;/strong&gt; be in the &amp;lt;head&amp;gt; of the HTML, don&#39;t believe them and question them.

PS: All tests were done from ie7 from Dulles, VA using &lt;a href=&#34;http://www.webpagetest.org/&#34;&gt;WebPageTest.org&lt;/a&gt;, ie8 also showed similar behavior.

&lt;h3&gt;Shameless Plug&lt;/h3&gt;
I am available for &lt;a href=&#34;https://www.sajalkayan.com/web-speed-consulting-services&#34;&gt;consulting on web speed issues&lt;/a&gt;, contact details in the right sidebar.

&lt;strong&gt;UPDATE: I am now using &lt;a href=&#34;http://www.aaronpeters.nl/blog/non-blocking-google-adsense-ads-improve-page-speed&#34;&gt;Aaron&#39;s adsense hack&lt;/a&gt; to defer DFP below the content. Thanks Aaron&lt;/strong&gt;
&lt;strong&gt;UPDATE 2: New Post: &lt;a href=&#34;https://www.sajalkayan.com/complete-asynchronous-ad-loading-using-dfp-and-labjs.html&#34;&gt;Complete Asynchronous ad loading using DFP and LABjs&lt;/a&gt;&lt;/strong&gt;
</description>
    </item>
    
    <item>
      <title>Twitter finally gets something right - Tweet Button</title>
      <link>https://www.sajalkayan.com/twitter-finally-gets-something-right-tweet-button.html</link>
      <pubDate>Fri, 13 Aug 2010 14:35:42 +0000</pubDate>
      
      <guid>https://www.sajalkayan.com/twitter-finally-gets-something-right-tweet-button.html</guid>
      <description>FAILing all the time is not new for Twitter, in fact they are the masters of FAIL. Twitter FAILs so often that seeing the obnoxious FAIL WHALE on a daily basis has become a way of life for most of us. Twitter is so experienced in the art of FAIL, that they are aware and &lt;a href=&#34;http://www.youtube.com/watch?v=_7KdeUIvlvw&#34;&gt;experienced&lt;/a&gt; in causes of FAIL and how to mitigate its effects.

Recently Twitter, for the first time ever, launched the &lt;a href=&#34;http://twitter.com/goodies/tweetbutton&#34;&gt;official Tweet button&lt;/a&gt; which one can put on their websites to allow the user to tweet easily and view the twitter based popularity of the page they are currently reading.

So whats new about this? 3rd providers like &lt;a href=&#34;http://tweetmeme.com/&#34;&gt;TweetMeme&lt;/a&gt; have had this functionality for years now. Let me explain ...

Firstly Twitters implementation of the Button

&lt;code&gt;
&amp;lt;a href=&#34;http://twitter.com/share&#34; class=&#34;twitter-share-button&#34; data-count=&#34;vertical&#34;&amp;gt;Tweet&amp;lt;/a&amp;gt;
&amp;lt;script type=&#34;text/javascript&#34; src=&#34;http://platform.twitter.com/widgets.js&#34;&amp;gt;&amp;lt;/script&amp;gt;
&lt;/code&gt;

Look closely, there is an &amp;lt;a&amp;gt; tag which sets the &lt;em&gt;class&lt;/em&gt; attribute, and then a &amp;lt;script&amp;gt; tag, which makes the magic happen. Take a look into their &lt;a href=&#34;http://platform.twitter.com/widgets.js&#34; rel=&#34;nofollow&#34;&gt;JavaScript&lt;/a&gt;, there are no nasty &lt;em&gt;document.write&lt;/em&gt;s in it. In fact, all it does is look for objects with the &lt;em&gt;twitter-share-button&lt;/em&gt; class and then that object accordingly. Now, if the &amp;lt;script&amp;gt; is placed just after &amp;lt;a&amp;gt; as advised by Twitter, the page load blocks while the JavaScript is downloaded and parsed, this in certain cases may drive away impatient users who don&#39;t like waiting for stupid buttons to load before they can interact with rest of the page.

Since Twitter&#39;s JavaScript doesn&#39;t use &lt;em&gt;document.write&lt;/em&gt;, the &amp;lt;script&amp;gt; can be included anywhere in the html provided it is after the &amp;lt;a&amp;gt; tag. the ideal position would be to place it just before &amp;lt;/body&amp;gt;. The result, adding this 3rd party widget induces no additional block in the rendering of the page. Implementing the Tweet Button in this manner has negligible impact on pageload.

This is how your page would look.

&lt;code lang=&#34;html&#34;&gt;
&amp;lt;html&amp;gt;
&amp;lt;head&amp;gt;
[...]
&amp;lt;/head&amp;gt;
&amp;lt;body&amp;gt;
[...]
&amp;lt;a href=&#34;http://twitter.com/share&#34; class=&#34;twitter-share-button&#34; data-count=&#34;vertical&#34;&amp;gt;Tweet&amp;lt;/a&amp;gt;
[...]
&amp;lt;script type=&#34;text/javascript&#34; src=&#34;http://platform.twitter.com/widgets.js&#34;&amp;gt;&amp;lt;/script&amp;gt;
&amp;lt;/body&amp;gt;
&amp;lt;/html&amp;gt;
&lt;/code&gt;

To make it asynchronous, the &amp;lt;script&amp;gt; tag can be implemented as such :-

&lt;code&gt;
&amp;lt;script id=&#34;deferedjs&#34; type=&#34;text/javascript&#34;&amp;gt;
var b = document.createElement(&#39;script&#39;);
b.type = &#39;text/javascript&#39;;
b.src = (&#39;http://platform.twitter.com/widgets.js&#39;);
var a=document.getElementById(&#34;deferedjs&#34;);
a.parentNode.insertBefore(b,a);
&amp;lt;/script&amp;gt;
&lt;/code&gt;

Now thats is truly non-blocking un-intrusive implementation of the button. It doesn&#39;t block the &lt;em&gt;onload&lt;/em&gt; event uselessly.

Now, Twitter didn&#39;t include these methods in the documentation probably because they didn&#39;t want to scare away regular bloggers and webmasters who aren&#39;t as paranoid about client side performance as some of us.

The Tweet Button uses &lt;a href=&#34;http://www.akamai.com/&#34;&gt;Akamai CDN&lt;/a&gt; to serve the assets, which is considered super stable. Currently sets an expires header of 1 hour (which I presume will be changed to far-future once things stabilize) and to top it off, it provides webmasters with an elegant JavaScript  which can be implemented such that the base page suffers very little(if any) even if their CDN goes down.

More experienced webmasters can even bundle this JavaScript into their own code, provided they regularly track changes and re-bundle often to avoid undesired consequences.

Now, see &lt;a href=&#34;http://help.tweetmeme.com/2009/04/06/tweetmeme-button/&#34;&gt;TweetMeme&#39;s implementation&lt;/a&gt; :-

&lt;code&gt;
&amp;lt;script type=&#34;text/javascript&#34; src=&#34;http://tweetmeme.com/i/scripts/button.js&#34;&amp;gt;&amp;lt;/script&amp;gt;
&lt;/code&gt;

Just take a look into their &lt;a href=&#34;http://tweetmeme.com/i/scripts/button.js&#34; rel=&#34;nofollow&#34;&gt;JavaScript&lt;/a&gt;. It uses a &lt;em&gt;document.write&lt;/em&gt; to write an Iframe. The JavaScript has to be downloaded, then parsed, then executed exactly at the moment it needs to be placed in sync with the rendering of the DOM. There is no way that I know of to make this truly asynchronous besides putting their script inside another iframe (which makes one additional request to your server).

TweetMeme hosts the javascript on their own servers, if their server is slow, the whole pageload would suffer. To top it off there is no way where a webmaster can take precautions against it.

My intention was not to single out TweetMeme, almost all 3rd party widgets make their code such that each of them are &lt;a href=&#34;http://www.stevesouders.com/blog/2010/06/01/frontend-spof/&#34;&gt;frontend SPOF&lt;/a&gt; for the websites that use them.

Moral of the story is that it is the responsibility of a 3rd party service providers to make their FAIL shouldn&#39;t make their users sites to FAIL completely.
</description>
    </item>
    
    <item>
      <title>Page Speed Analysis: Search Engine Roundtable</title>
      <link>https://www.sajalkayan.com/page-speed-analysis-search-engine-roundtable.html</link>
      <pubDate>Fri, 30 Jul 2010 17:25:40 +0000</pubDate>
      
      <guid>https://www.sajalkayan.com/page-speed-analysis-search-engine-roundtable.html</guid>
      <description>I am planing to do a series of posts on analyzing popular websites I visit frequently. By now I am so &lt;a href=&#34;https://www.sajalkayan.com/attn-big-media-web-page-speed-matters.html&#34; title=&#34;ATTN Big Media: Web page speed matters!&#34;&gt;obsessed to optimize for speed&lt;/a&gt; that I&#39;ve run out of sites to optimize, hence I&#39;m doing it for other sites.

To start with I&#39;ll analyze &lt;a href=&#34;http://www.seroundtable.com/&#34;&gt;Search Engine Roundtable&lt;/a&gt;.

Before I start, wanna make it absolutely clear that I am not looking to make the site owners or webmasters look bad. &lt;a href=&#34;http://en.wikipedia.org/wiki/Barry_Schwartz_%28technologist%29&#34;&gt;Barry Schwartz&lt;/a&gt;, editor of &lt;em&gt;SERoundtable.com&lt;/em&gt;, tells me &lt;em&gt;&#34;The site is old and is being completely revamped from bottom up.&#34;&lt;/em&gt;

About &lt;em&gt;SERoundtable.com&lt;/em&gt; :-

Traffic Rank: 5,738 (&lt;a href=&#34;http://www.alexa.com/siteinfo/seroundtable.com&#34;&gt;Alexa&lt;/a&gt;), 16,804 (compete)
Browsers : Assuming lesser than average Internet Explorer users based on the nature of the target demographics.

My assumption is that the site targets regular (loyal) readers, so I place more emphasis on repeat views and caching.

&lt;h3&gt;The Problem&lt;/h3&gt;

The website is slow, I access it regularly and loose productivity while waiting for the pages to load.

Page Load times (using &lt;a href=&#34;http://www.webpagetest.org/&#34;&gt;WebPageTest.org&lt;/a&gt; - &lt;a href=&#34;http://www.webpagetest.org/result/100729_21GK/&#34; rel=&#34;nofollow&#34;&gt;here&lt;/a&gt; and &lt;a href=&#34;http://www.webpagetest.org/result/100729_21GM/&#34; rel=&#34;nofollow&#34;&gt;here&lt;/a&gt;):

&lt;table border=&#34;1&#34; cellspacing=&#34;0&#34;&gt;
    &lt;tr&gt;
        &lt;th&gt;Page&lt;/th&gt;
        &lt;th&gt;Start Render&lt;/th&gt;
        &lt;th&gt;Load Time&lt;/th&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
        &lt;td&gt;Home Page - First View&lt;/td&gt;
        &lt;td&gt;1.894s&lt;/td&gt;
        &lt;td&gt;9.733s&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
        &lt;td&gt;Home Page - Repeat View&lt;/td&gt;
        &lt;td&gt;0.914s&lt;/td&gt;
        &lt;td&gt;4.619s&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
        &lt;td&gt;Individual Post - First View&lt;/td&gt;
        &lt;td&gt;1.539s&lt;/td&gt;
        &lt;td&gt;11.855s&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
        &lt;td&gt;Individual Post - Repeat View&lt;/td&gt;
        &lt;td&gt;0.858s&lt;/td&gt;
        &lt;td&gt;5.171s&lt;/td&gt;
    &lt;/tr&gt;
&lt;/table&gt;

Web Speed Rankings (Using &lt;a href=&#34;http://www.showslow.com/&#34;&gt;Show Slow&lt;/a&gt;):-
&lt;table border=&#34;1&#34; cellspacing=&#34;0&#34;&gt;
    &lt;tr&gt;
        &lt;th&gt;Page&lt;/th&gt;
        &lt;th&gt;Yslow grade&lt;/th&gt;
        &lt;th&gt;Page Speed score&lt;/th&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
        &lt;td&gt;&lt;a href=&#34;http://www.showslow.com/details/?url=http%3A%2F%2Fwww.seroundtable.com%2F&#34; rel=&#34;nofollow&#34;&gt;Homepage&lt;/a&gt;&lt;/td&gt;
        &lt;td&gt;D (65)&lt;/td&gt;
        &lt;td&gt;C (74)&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
        &lt;td&gt;&lt;a href=&#34;http://www.showslow.com/details/?url=http%3A%2F%2Fwww.seroundtable.com%2Farchives%2F022625.html&#34; rel=&#34;nofollow&#34;&gt;Individual Post&lt;/a&gt;&lt;/td&gt;
        &lt;td&gt;D (64)&lt;/td&gt;
        &lt;td&gt;C (75)&lt;/td&gt;
    &lt;/tr&gt;
&lt;/table&gt;

&lt;a href=&#34;http://www.webpagetest.org/video/compare.php?tests=100729_21GK%2C100729_21GM&amp;thumbSize=200&amp;ival=100&#34; rel=&#34;nofollow&#34;&gt;Visual Latency&lt;/a&gt; (tested from Dulles, VA using IE7): 

Homepage : 2.5 seconds
Post Page : 2.6 seconds

(The timing I&#39;ve used here is the time at which the page becomes somewhat usable, this in my definition is the time at which the content title and body is shown on the screen. This is the time at which the user can start engaging with the site while other stuff loads.)

&lt;object width=&#34;488&#34; height=&#34;300&#34;&gt;&lt;param name=&#34;movie&#34; value=&#34;http://www.youtube.com/v/FfaPq3DEjpM&amp;amp;hl=en_US&amp;amp;fs=1&#34;&gt;&lt;/param&gt;&lt;param name=&#34;allowFullScreen&#34; value=&#34;true&#34;&gt;&lt;/param&gt;&lt;param name=&#34;allowscriptaccess&#34; value=&#34;always&#34;&gt;&lt;/param&gt;&lt;embed src=&#34;http://www.youtube.com/v/FfaPq3DEjpM&amp;amp;hl=en_US&amp;amp;fs=1&#34; type=&#34;application/x-shockwave-flash&#34; allowscriptaccess=&#34;always&#34; allowfullscreen=&#34;true&#34; width=&#34;488&#34; height=&#34;300&#34;&gt;&lt;/embed&gt;&lt;/object&gt;

Thus you can see that for whole 2.5 seconds the user is doing nothing but staring at an almost blank screen.

So we have a problem here, unoptimized websites open exponentially slower from across the globe in Thailand especially when using crappy ISPs. So whats the solution?

&lt;h3&gt;The Solution&lt;/h3&gt;

Firstly, kudos to &lt;em&gt;SERoundtable.com&lt;/em&gt; for using Source Ordered Content(SOC). This ensures that the title and text of the post is the first thing to render on the page, lesser susceptible to &lt;a href=&#34;http://www.stevesouders.com/blog/2010/06/01/frontend-spof/&#34;&gt;Frontend SPOF&lt;/a&gt;. The reason for SOC here may or may not be for SEO purposes, but in terms of page speed this is a valuable optimizations. Also try to move the adslot SER-HOME-468x60-1 to below the content.

Now the things that needs to be changed (In order of importance as I see it) :-


&lt;ol&gt;
    &lt;li&gt;&lt;strong&gt;Minimize the number of requests&lt;/strong&gt; : The time taken to load the page is somewhat directly proportional to the number of requests. Most people these days use high speed internet access which basically gives them a higher bandwidth but not better speed (latency). The following steps need to be implemented to reduce the number of requests.
    &lt;ol&gt;
        &lt;li&gt;&lt;strong&gt;Disable Etags and add far futures cache headers for static objects&lt;/strong&gt; (Easy/Urgent/Obvious): 49 of the 50 requests made to www.seroundtable.com are non frequently changing static files (CSS, images, etc). Currently the browsers send a &lt;em&gt;If-Modified-Since&lt;/em&gt; requests to all of them to check if it has changed since then or not. My advise is to send expires headers to at least 7 days( &gt; 30 days preferred) in the future. This would make repeat views amazingly fast. Quite easy to implement &lt;a href=&#34;http://www.askapache.com/htaccess/apache-speed-cache-control.html&#34;&gt;cache control in Apache&lt;/a&gt;. &lt;a href=&#34;http://en.wikipedia.org/wiki/HTTP_ETag&#34;&gt;Etags&lt;/a&gt; don&#39;t serve much purpose here, require a tiny bit of CPU for each request, useless information IMHO.&lt;/li&gt;
        &lt;li&gt; &lt;strong&gt;Use &lt;a href=&#34;http://www.alistapart.com/articles/sprites&#34;&gt;CSS Sprites&lt;/a&gt;&lt;/strong&gt; (Easy - Intermediate): Request for following files can easily be sprited (after converting everything to either gif or png - png prefered) -- nav_previous.gif, nav_next.gif, h2.gif, 3dots.gif, pen.png, sphinn-favicon.png, Twitter-16x16.png, digg-favicon.jpg, barry.png, entry-footer.png, comforminput.gif, comformtextarea.gif, sbauthors.gif, sbarchives.gif, sbmoreinfo.gif, mbg.jpg, sbhome.gif, sbourforums.gif, delicious-favicon.png, google-favicon-16.png, sbtheforums.gif, arrow_yellow.gif, rss.gif, foo.jpg, credits.jpg - Thats a reduction of &lt;strong&gt;24&lt;/strong&gt; requests!&lt;/li&gt;
        &lt;li&gt; &lt;strong&gt;Use &lt;a href=&#34;http://en.wikipedia.org/wiki/Data_URI_scheme&#34;&gt;Data-URI&lt;/a&gt; for the tiny background files&lt;/strong&gt; (Advanced/Optional): Embed the tiny background files directly inside the CSS using Data URI Scheme. The drawback is IE7 and below dont support this, the workaround is to use the &lt;a href=&#34;http://www.evotech.net/blog/2007/04/ie7-only-css-hacks/#star&#34;&gt;star hack&lt;/a&gt; to send them the current background settings. Another drawback is this would increase the size of the CSS file, but the total size after compression(see below) would be about the same as the current total size. This optimization reduces the need for the following files in all non IE browsers and IE8 -- sbbg.gif, formbg.gif, mbg.jpg, sbhbg.gif, sboxbg.gif, tbbg.gif, rcredbg.gif, rcbg.gif, threadlibg.gif, bg.gif, hbgleft.jpg, msep.gif, fbg.gif - Thats elimination of &lt;strong&gt;13&lt;/strong&gt; requests! Another advantage is that the css file starts to download much before actual rendering starts, this at the start of rendering, these files would already be available, making the background graphics appear almost instantly without additional blocking of rest of the page.&lt;/li&gt;
    &lt;/ol&gt;
So Out of 50 requests made to www.seroundtable.com, 37 of them can be completely eliminated for first view, for repeat views almost all but base page should be cached.&lt;/li&gt;

    &lt;li&gt;&lt;strong&gt;Enable Keep-Alive&lt;/strong&gt;(Easy/Obvious): An uncached pageload makes about 50 requests to www.seroundtable.com. For each of these requests, the client must make a new connection with the server. Enabling Keep-Alive can get the job done in much fewer(depends on browsers parallel connection policies) connections, thus saving dozens of round-trips. Enabling keep-alive does increase memory utilization on the server, but the benefits are greater. See this &lt;a href=&#34;http://www.webpagetest.org/result/100729_f53996276504cd0c9759ed2cd2a210c8/1/details/&#34; rel=&#34;nofollow&#34;&gt;chart&lt;/a&gt;, the brown portion of the loadtime can be removed for ~90% of the requests. &lt;a href=&#34;http://www.smartsoftwarebits.com/qaa/46-misc/85-howto-set-keepalive-in-apache-httpd&#34; title=&#34; HOWTO Set KeepAlive in Apache HTTPd&#34;&gt;Here&lt;/a&gt; are some instructions for Apache.&lt;/li&gt;

    &lt;li&gt;Optimize each request : Reduce the size of each request/response using the following methods
    &lt;ol&gt;
        &lt;li&gt;&lt;strong&gt;Gzip text assets&lt;/strong&gt; (Easy/Obvious): About 75% of data transfer for the base page and the css file can be reduced by simple &lt;a href=&#34;http://www.askapache.com/htaccess/apache-speed-compression.html#menu0-el0&#34;&gt;enabling gzip&lt;/a&gt; on Apache.&lt;/li&gt;
        &lt;li&gt; &lt;strong&gt;Compress images&lt;/strong&gt;(Easy) : My favorite tool for this is &lt;a href=&#34;http://developer.yahoo.com/yslow/smushit/&#34;&gt;Smush.it&lt;/a&gt; by Yahoo! Similar results can be achieved using say GIMP or Photoshop.&lt;/li&gt;
        &lt;li&gt; &lt;strong&gt;Use cookie-less domain for static content&lt;/strong&gt;(Easy/Important): Serve static files(images/css/etc) from an external domain. Currently, the site sets cookies which the browser automatically sends with each subsequent request to the server while requesting static files. This cookie information is absolutely useless to the server and causes the request size to be big. The workaround is to host these files on another dedicated cookieless domain, say www.serassets.com or something. This tip may not sound important, in fact I used to ignore it, but once implemented the effects are HUGE.&lt;/li&gt;
        &lt;li&gt; &lt;strong&gt;Minify code&lt;/strong&gt; (Easy/Optional): Minify HTML, run the inline javascript using &lt;a href=&#34;http://closure-compiler.appspot.com/home&#34;&gt;Google&#39;s Closure Compiler&lt;/a&gt; for faster execution. Smaller files also require lesser resources on the browser.&lt;/li&gt;
        &lt;li&gt; &lt;strong&gt;Use a CDN&lt;/strong&gt;(Easy): A &lt;a href=&#34;https://www.sajalkayan.com/make-your-own-cheap-charlie-cdn.html&#34; title=&#34;Make your own cheap charlie CDN&#34;&gt;CDN (Content Delivery Network)&lt;/a&gt; mantains POPs (Point Of Presence) globally, and can be used to serve the static files(images, javascripts, css, etc) which would be served from a server closer to you. The charges are not much. So if &lt;em&gt;SERoundtable.com&lt;/em&gt; used say &lt;a href=&#34;http://www.internap.com/&#34;&gt;Internap&lt;/a&gt;, I would be accessing the static files from a server in Singapore instead of US. In case of &lt;a href=&#34;http://www.akamai.com/&#34;&gt;Akamai&lt;/a&gt; I&#39;d be accessing the static assets from a server within my ISPs network! Choose any from this &lt;a href=&#34;http://www.mytestbox.com/miscellaneous/content-delivery-networks-cdn-list/&#34;&gt;list of CDNs&lt;/a&gt;.&lt;/li&gt;
    &lt;/ol&gt;
&lt;/li&gt;

&lt;li&gt;Onpage/rendering optimizations: 
    &lt;ol&gt;
        &lt;li&gt; &lt;strong&gt;Choose &amp;lt;link&amp;gt; over @import&lt;/strong&gt; (Easy): Yahoo! &lt;a href=&#34;http://developer.yahoo.com/performance/rules.html#csslink&#34;&gt;explains&lt;/a&gt; it better than I can. Affects usability in IE, delays rendering.&lt;/li&gt;
        &lt;li&gt; &lt;strong&gt;Move the inline JavaScript into an external file&lt;/strong&gt; (Easy): This would make the page load faster for repeat users since the base page would be lighter and the JavaScript file would already be cached in the client&#39;s browser (or at upstream proxy). Make sure to minify the JavaScript (see point 3-4)&lt;/li&gt;
        &lt;li&gt; &lt;strong&gt;Move JavaScript to the end&lt;/strong&gt; (Intermediate): The JavaScript files/codes that are not necessary to be accessed during the page rendering, should be moved to the bottom of the page just before &lt;em&gt;&lt;/body&gt;&lt;/em&gt; or just before they are needed.&lt;/li&gt;
        &lt;li&gt; &lt;strong&gt;Use the &lt;a href=&#34;http://code.google.com/apis/analytics/docs/tracking/asyncTracking.html&#34;&gt;Async Google Analytics Code&lt;/a&gt;&lt;/strong&gt;(Easy): The new method really doesn&#39;t block the rest of the page. The current &lt;em&gt;document.write&lt;/em&gt; method in the &lt;em&gt;&lt;head&gt;&lt;/em&gt; section blocks rendering on many browsers.&lt;/li&gt;
        &lt;li&gt; &lt;strong&gt;Move &lt;a href=&#34;https://www.google.com/dfp/&#34;&gt;DFP&lt;/a&gt; code lower&lt;/strong&gt;(Intermediate): Right now, the javascript code for DFP is placed within the &lt;em&gt;&lt;head&gt;&lt;/em&gt; section, this makes 3 serial blocking requests which must be downloaded and executed before rest of the elements download and render blocking the page for 500 to 1000 ms. My suggestion is to move this just above the first Adblock(the &lt;em&gt;GA_googleFillSlot()&lt;/em&gt; calls) in the HTML. This combined with the current Source Ordered Content architecture will ensure that the users will feel minimal impact even if DFP has problems.&lt;/li&gt;
        &lt;li&gt; &lt;strong&gt;Try using &lt;a href=&#34;http://www.google.com/support/dfp_sb/bin/answer.py?hl=en&amp;answer=90777&#34;&gt;DFP&#39;s Iframe tagging&lt;/a&gt;&lt;/strong&gt; (Easy but Experimental/Risky): The major drawback to this is that it may mess up &lt;a href=&#34;http://en.wikipedia.org/wiki/Online_advertising#Types&#34;&gt;expandable ads&lt;/a&gt;, which I don&#39;t think &lt;em&gt;SERoundtable.com&lt;/em&gt; uses. If you notice the &lt;a href=&#34;http://www.youtube.com/watch?v=FfaPq3DEjpM&#34;&gt;video&lt;/a&gt; above, notice starting from about the &lt;a href=&#34;http://www.youtube.com/watch?v=FfaPq3DEjpM#t=0m20s&#34;&gt;4 second mark&lt;/a&gt;, currently the 6 adblocks load one by one. With the Iframe tagging, they would load independently, not blocking each other or the rest of the page. A major protection from frontend SPOF due to 3rd party ad networks. Personally I am impressed with the results of this method.&lt;/li&gt;
        &lt;li&gt; &lt;strong&gt;&lt;a href=&#34;http://yuiblog.com/blog/2007/04/11/performance-research-part-4/&#34;&gt;Domain Sharding&lt;/a&gt;&lt;/strong&gt; (Advanced): Split requests across several domains like static1.seroundtable.com, static2.seroundtable.com, static3.seroundtable.com, etc to increase parallel downloads. The downside is that this results in increased DNS lookups which is bad. Fortunately there is a &lt;a href=&#34;http://www.webpagetest.org/forums/showthread.php?tid=289&amp;pid=1329#pid1329&#34; title=&#34;nested DNS CNAME hack&#34;&gt;workaround&lt;/a&gt; to this issue.&lt;/li&gt;
    &lt;/ol&gt;
&lt;/li&gt;
&lt;/ol&gt;


&lt;h3&gt;Conclusions&lt;/h3&gt;

Apart from the tips above make sure to read the &lt;a href=&#34;http://developer.yahoo.com/performance/rules.html&#34; title=&#34;Best Practices for Speeding Up Your Web Site&#34;&gt;best&lt;/a&gt; &lt;a href=&#34;http://code.google.com/speed/page-speed/docs/rules_intro.html&#34; title=&#34;Web Performance Best Practices&#34;&gt;practices&lt;/a&gt; for faster websites. Most of what I&#39;ve suggested is redundant from the best practices, tailored to this particular website. Lots more can be done, but at the moment compare to what I&#39;ve mentioned above, the effects of additional optimizations may seem like a waste of time.

Just a reminder that I&#39;ve been told that &lt;em&gt;SERoundtable.com&lt;/em&gt; is revamping the entire site and it &#34;is really a full revamp from the CMS to the html on the frontend.&#34;.

Implementation of most of the above tips would make at least one reader of &lt;em&gt;SERoundtable.com&lt;/em&gt; very happy :).

Total time spent : &gt;= 5 hours.

Appreciate any criticism of my analysis via comments below.

A word of caution to other optimizers, don&#39;t get over obsessed with yslow, Google page speed or page load times, its the visitors experience which matters the most. Optimize for visual latency more than bragging rights!

&lt;h3&gt;Shameless Plug&lt;/h3&gt;

I am available for &lt;a href=&#34;https://www.sajalkayan.com/web-speed-consulting-services&#34;&gt;consulting on web speed issues&lt;/a&gt;, contact details in the right sidebar.
</description>
    </item>
    
    <item>
      <title>ATTN Big Media: Web page speed matters!</title>
      <link>https://www.sajalkayan.com/attn-big-media-web-page-speed-matters.html</link>
      <pubDate>Sun, 04 Jul 2010 14:59:50 +0000</pubDate>
      
      <guid>https://www.sajalkayan.com/attn-big-media-web-page-speed-matters.html</guid>
      <description>I am not a front-end kinda guy, but these days my latest obsession is to test and improve web page loading times. With this blogpost, I intend to show with examples of some selected websites and what are they doing right and what *desperately* needs to be improved. As I learn more about this I will be posting more in-depth posts on these issues.

&lt;h4&gt;Why does it matter?&lt;/h4&gt;

These days almost everyone is on high-speed &#39;broadband&#39; connections so the sites should load fast. Right? No! With faster connectivity, users get more impatient and expect websites to load faster. 

E-Commerce websites have done &lt;a href=&#34;http://radar.oreilly.com/2008/08/radar-theme-web-ops.html&#34;&gt;studies&lt;/a&gt; which proove faster sites results in more sales. Google has also been &lt;a href=&#34;http://www.youtube.com/watch?v=MStKwEff_kY&#34; title=&#34;Velocity 2010: Urs Holzle&#34;&gt;advocating&lt;/a&gt; to webmasters to improve their pageload times. Now &lt;a href=&#34;http://googlewebmastercentral.blogspot.com/2010/04/using-site-speed-in-web-search-ranking.html&#34; title=&#34;Using site speed in web search ranking&#34;&gt;pageload is a signal for ranking in Google&lt;/a&gt;, abit a minor signal, but it still matters.

Overall faster websites &lt;a href=&#34;http://googleresearch.blogspot.com/2009/06/speed-matters.html&#34;&gt;results&lt;/a&gt; in a &lt;a href=&#34;http://www.stevesouders.com/blog/2009/07/27/wikia-fast-pages-retain-users/&#34; title=&#34;Wikia: fast pages retain users&#34;&gt;higher user retention&lt;/a&gt;. Faster websites also &lt;a href=&#34;http://radar.oreilly.com/2009/07/velocity-making-your-site-fast.html&#34;&gt;lower operational costs&lt;/a&gt;. Not directly related, but an optimized website is also less susceptible to &lt;a href=&#34;http://www.stevesouders.com/blog/2010/06/01/frontend-spof/&#34;&gt;Frontend SPOF&lt;/a&gt;.

&lt;h4&gt;Analysis of pageload time&lt;/h4&gt;

My favorite tool for this is &lt;a href=&#34;http://www.webpagetest.org/&#34; title=&#34;Pagetest - where web sites go to get FAST!&#34;&gt;webpagetest.org&lt;/a&gt;. They also have an active &lt;a href=&#34;http://www.webpagetest.org/forums/&#34;&gt;forum&lt;/a&gt; where users can discuss results and exchange tips on making it faster.

Some test results :-

&lt;table border=&#34;1&#34; cellspacing=&#34;0&#34; &gt;
    &lt;tr&gt;
        &lt;th&gt;Site&lt;/th&gt;
        &lt;th&gt;Alexa Rank&lt;/th&gt;
        &lt;th&gt;First View&lt;/th&gt;
        &lt;th&gt;Repeat View&lt;/th&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
        &lt;th colspan=&#34;4&#34;&gt;My Sites&lt;/th&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
        &lt;td&gt;&lt;a href=&#34;https://www.sajalkayan.com/&#34; title=&#34;Sajal Kayan&#34;&gt;Main blog page&lt;/a&gt;&lt;/td&gt;
		&lt;td&gt;436,669&lt;/td&gt;
        &lt;td&gt;&lt;a href=&#34;http://www.webpagetest.org/result/100703_2a389e9913355156fe514dad6496fa1f/&#34; rel=&#34;nofollow&#34;&gt;1.512s&lt;/a&gt;&lt;/td&gt;
        &lt;td&gt;&lt;a href=&#34;http://www.webpagetest.org/result/100703_2a389e9913355156fe514dad6496fa1f/&#34; rel=&#34;nofollow&#34;&gt;1.038s&lt;/a&gt;&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
        &lt;td&gt;A single &lt;a href=&#34;https://www.sajalkayan.com/in-a-cdnd-world-opendns-is-the-enemy.html&#34; title=&#34;In a CDNd world, OpenDNS is the enemy!&#34;&gt;post&lt;/a&gt; page on my blog.&lt;/td&gt;
		&lt;td&gt;436,669&lt;/td&gt;
        &lt;td&gt;&lt;a href=&#34;http://www.webpagetest.org/result/100630_f939860d7469491b4445dbd93d9fd9a2/&#34; rel=&#34;nofollow&#34;&gt;0.822s&lt;/a&gt;&lt;/td&gt;
        &lt;td&gt;&lt;a href=&#34;http://www.webpagetest.org/result/100630_f939860d7469491b4445dbd93d9fd9a2/&#34; rel=&#34;nofollow&#34;&gt;0.648s&lt;/a&gt;&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
        &lt;td&gt;&lt;a href=&#34;http://www.thaindian.com/&#34; title=&#34;Thaindian News&#34;&gt;Thaindian.com Homepage&lt;/a&gt;&lt;/td&gt;
		&lt;td&gt;5,368&lt;/td&gt;
        &lt;td&gt;&lt;a href=&#34;http://www.webpagetest.org/result/100703_c7ab5a556aa0ce97fef055be59c4a520/&#34; rel=&#34;nofollow&#34;&gt;0.740s&lt;/a&gt;&lt;/td&gt;
        &lt;td&gt;&lt;a href=&#34;http://www.webpagetest.org/result/100703_c7ab5a556aa0ce97fef055be59c4a520/&#34; rel=&#34;nofollow&#34;&gt;0.514s&lt;/a&gt;&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
        &lt;td&gt;A &lt;a href=&#34;http://www.thaindian.com/newsportal/politics/us-vice-president-joe-biden-arrives-in-baghdad-on-surprise-visit_100390256.html&#34; title=&#34;U.S. Vice President Joe Biden arrives in Baghdad on surprise visit&#34;&gt;story page&lt;/a&gt; on Thaindian News&lt;/td&gt;
		&lt;td&gt;5,368&lt;/td&gt;
        &lt;td&gt;&lt;a href=&#34;http://www.webpagetest.org/result/100703_e4da8ccb9799cf9fde59b0b3137aae71/&#34; rel=&#34;nofollow&#34;&gt;4.517s&lt;/a&gt;&lt;/td&gt;
        &lt;td&gt;&lt;a href=&#34;http://www.webpagetest.org/result/100703_e4da8ccb9799cf9fde59b0b3137aae71/&#34; rel=&#34;nofollow&#34;&gt;3.411s&lt;/a&gt;&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
        &lt;th colspan=&#34;4&#34;&gt;Sites for Geeks/nerds&lt;/th&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
        &lt;td&gt;&lt;a href=&#34;http://stackoverflow.com/&#34;&gt;Stack Overflow&lt;/a&gt;&lt;/td&gt;
		&lt;td&gt;445&lt;/td&gt;
        &lt;td&gt;&lt;a href=&#34;http://www.webpagetest.org/result/100703_1f13821a589ccc393783bcd07c3d8fc6/&#34; rel=&#34;nofollow&#34;&gt;2.233s&lt;/a&gt;&lt;/td&gt;
        &lt;td&gt;&lt;a href=&#34;http://www.webpagetest.org/result/100703_1f13821a589ccc393783bcd07c3d8fc6/&#34; rel=&#34;nofollow&#34;&gt;1.734s&lt;/a&gt;&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
        &lt;td&gt;A &lt;a href=&#34;http://stackoverflow.com/questions/3172298/gcc-xcode-speedup-suggestions&#34;&gt;single&lt;/a&gt; thread at Stack Overflow&lt;/td&gt;
		&lt;td&gt;445&lt;/td&gt;
        &lt;td&gt;&lt;a href=&#34;http://www.webpagetest.org/result/100703_b935a42bd57a347c9cb8dba3ef94269d/&#34; rel=&#34;nofollow&#34;&gt;2.846s&lt;/a&gt;&lt;/td&gt;
        &lt;td&gt;&lt;a href=&#34;http://www.webpagetest.org/result/100703_b935a42bd57a347c9cb8dba3ef94269d/&#34; rel=&#34;nofollow&#34;&gt;2.645s&lt;/a&gt;&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
        &lt;td&gt;&lt;a href=&#34;http://slashdot.org/&#34;&gt;Slashdot.Org&lt;/a&gt;&lt;/td&gt;
		&lt;td&gt;1,393&lt;/td&gt;
        &lt;td&gt;&lt;a href=&#34;http://www.webpagetest.org/result/100703_b81b1c497021b36a776bc5626d4660d3/&#34; rel=&#34;nofollow&#34;&gt;3.773s&lt;/a&gt;&lt;/td&gt;
        &lt;td&gt;&lt;a href=&#34;http://www.webpagetest.org/result/100703_b81b1c497021b36a776bc5626d4660d3/&#34; rel=&#34;nofollow&#34;&gt;2.175s&lt;/a&gt;&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
        &lt;td&gt;A &lt;a href=&#34;http://tech.slashdot.org/story/10/05/29/1355252/How-CDNs-and-Alternative-DNS-Services-Combine-For-Higher-Latency&#34; title=&#34;How CDNs and Alternative DNS Services Combine For Higher Latency&#34;&gt;single&lt;/a&gt; thread at Slashdot&lt;/td&gt;
		&lt;td&gt;1,393&lt;/td&gt;
        &lt;td&gt;&lt;a href=&#34;http://www.webpagetest.org/result/100703_cf6076bf98dc973a471b93ee744498f3/&#34; rel=&#34;nofollow&#34;&gt;3.817s&lt;/a&gt;&lt;/td&gt;
        &lt;td&gt;&lt;a href=&#34;http://www.webpagetest.org/result/100703_cf6076bf98dc973a471b93ee744498f3/&#34; rel=&#34;nofollow&#34;&gt;2.100s&lt;/a&gt;&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
        &lt;th colspan=&#34;4&#34;&gt;New media&lt;/th&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
        &lt;td&gt;&lt;a href=&#34;http://www.huffingtonpost.com/&#34;&gt;The Huffington Post&lt;/a&gt;&lt;/td&gt;
		&lt;td&gt;152&lt;/td&gt;
        &lt;td&gt;&lt;a href=&#34;http://www.webpagetest.org/result/100703_46337caf586714160d7fa61340a04ed1/&#34; rel=&#34;nofollow&#34;&gt;6.945s&lt;/a&gt;&lt;/td&gt;
        &lt;td&gt;&lt;a href=&#34;http://www.webpagetest.org/result/100703_46337caf586714160d7fa61340a04ed1/&#34; rel=&#34;nofollow&#34;&gt;4.044s&lt;/a&gt;&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
        &lt;td&gt;A &lt;a href=&#34;http://www.huffingtonpost.com/2010/07/03/california-state-workers_n_634695.html&#34; title=&#34;California State Workers Brace For Minimum Wage&#34;&gt;single post on HuffPo&lt;/td&gt;
		&lt;td&gt;152&lt;/td&gt;
        &lt;td&gt;&lt;a href=&#34;http://www.webpagetest.org/result/100703_f23780e62939a0ba7c00d6e960bef6d2/&#34; rel=&#34;nofollow&#34;&gt;7.563s&lt;/a&gt;&lt;/td&gt;
        &lt;td&gt;&lt;a href=&#34;http://www.webpagetest.org/result/100703_f23780e62939a0ba7c00d6e960bef6d2/&#34; rel=&#34;nofollow&#34;&gt;4.416s&lt;/a&gt;&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
        &lt;td&gt;&lt;a href=&#34;http://techcrunch.com/&#34;&gt;TechCrunch&lt;/a&gt;&lt;/td&gt;
		&lt;td&gt;357&lt;/td&gt;
        &lt;td&gt;&lt;a href=&#34;http://www.webpagetest.org/result/100703_ae0469e4f1a4127ff10d71c38178c166/&#34; rel=&#34;nofollow&#34;&gt;16.462s&lt;/a&gt;&lt;/td&gt;
        &lt;td&gt;&lt;a href=&#34;http://www.webpagetest.org/result/100703_ae0469e4f1a4127ff10d71c38178c166/&#34; rel=&#34;nofollow&#34;&gt;14.760s&lt;/a&gt;&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
        &lt;td&gt;An &lt;a href=&#34;http://techcrunch.com/2010/07/03/facetime-and-why-apples-massive-integration-advantage-is-just-beginning/&#34; title=&#34;FaceTime and Why Apples Massive Integration Advantage is Just Beginning&#34;&gt;individual&lt;/a&gt; post on TechCrunch&lt;/td&gt;
		&lt;td&gt;357&lt;/td&gt;
        &lt;td&gt;&lt;a href=&#34;http://www.webpagetest.org/result/100703_aa34704a0c7596e5df80a695bab87022/&#34; rel=&#34;nofollow&#34;&gt;10.987s&lt;/a&gt;&lt;/td&gt;
        &lt;td&gt;&lt;a href=&#34;http://www.webpagetest.org/result/100703_aa34704a0c7596e5df80a695bab87022/&#34; rel=&#34;nofollow&#34;&gt;6.764s&lt;/a&gt;&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
        &lt;td&gt;&lt;a href=&#34;http://www.readwriteweb.com/&#34;&gt;ReadWriteWeb&lt;/a&gt;&lt;/td&gt;
		&lt;td&gt;1,996&lt;/td&gt;
        &lt;td&gt;&lt;a href=&#34;http://www.webpagetest.org/result/100703_610dde132450be8c91bd00cc18d63f90/&#34; rel=&#34;nofollow&#34;&gt;17.766s&lt;/a&gt;&lt;/td&gt;
        &lt;td&gt;&lt;a href=&#34;http://www.webpagetest.org/result/100703_610dde132450be8c91bd00cc18d63f90/&#34; rel=&#34;nofollow&#34;&gt;11.643s&lt;/a&gt;&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
        &lt;td&gt;A &lt;a href=&#34;http://www.readwriteweb.com/archives/paperli_gets_investment_for_its_twitter_newspapers.php&#34; title=&#34;Paper.li Gets Investment for Its Twitter Newspapers&#34;&gt;single&lt;/a&gt; post on ReadWriteWeb&lt;/td&gt;
		&lt;td&gt;1,996&lt;/td&gt;
        &lt;td&gt;&lt;a href=&#34;http://www.webpagetest.org/result/100703_ba46f8d118c183e10c8b22635c276630/&#34; rel=&#34;nofollow&#34;&gt;18.890s&lt;/a&gt;&lt;/td&gt;
        &lt;td&gt;&lt;a href=&#34;http://www.webpagetest.org/result/100703_ba46f8d118c183e10c8b22635c276630/&#34; rel=&#34;nofollow&#34;&gt;10.408s&lt;/a&gt;&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
        &lt;th colspan=&#34;4&#34;&gt;Big media&lt;/th&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
        &lt;td&gt;&lt;a href=&#34;http://news.google.com/&#34;&gt;Google News&lt;/a&gt;&lt;/td&gt;
		&lt;td&gt;1&lt;/td&gt;
        &lt;td&gt;&lt;a href=&#34;http://www.webpagetest.org/result/100704_625c0dac7cbe78df617239a9b5a125bb/&#34; rel=&#34;nofollow&#34;&gt;3.253s&lt;/a&gt;&lt;/td&gt;
        &lt;td&gt;&lt;a href=&#34;http://www.webpagetest.org/result/100704_625c0dac7cbe78df617239a9b5a125bb/&#34; rel=&#34;nofollow&#34;&gt;1.365s&lt;/a&gt;&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
        &lt;td&gt;Single &lt;a href=&#34;http://www.google.com/hostednews/ap/article/ALeqM5hvWEqwq3CrRvaQCmt21MfoYhjZJQD9GO6HI80&#34; title=&#34;Petraeus: We are in this to win in Afghanistan&#34; rel=&#34;nofollow&#34;&gt;story&lt;/a&gt; on Google News&lt;/td&gt;
		&lt;td&gt;1&lt;/td&gt;
        &lt;td&gt;&lt;a href=&#34;http://www.webpagetest.org/result/100704_ba30dd802cd14323a2e2e840034cf0ce/&#34; rel=&#34;nofollow&#34;&gt;2.688s&lt;/a&gt;&lt;/td&gt;
        &lt;td&gt;&lt;a href=&#34;http://www.webpagetest.org/result/100704_ba30dd802cd14323a2e2e840034cf0ce/&#34; rel=&#34;nofollow&#34;&gt;1.238s&lt;/a&gt;&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
        &lt;td&gt;&lt;a href=&#34;http://news.yahoo.com/&#34;&gt;Yahoo! News&lt;/a&gt;&lt;/td&gt;
		&lt;td&gt;4&lt;/td&gt;
        &lt;td&gt;&lt;a href=&#34;http://www.webpagetest.org/result/100704_170206d154d05ef42b622636c1a58f1c/&#34; rel=&#34;nofollow&#34;&gt;3.174s&lt;/a&gt;&lt;/td&gt;
        &lt;td&gt;&lt;a href=&#34;http://www.webpagetest.org/result/100704_170206d154d05ef42b622636c1a58f1c/&#34; rel=&#34;nofollow&#34;&gt;1.707s&lt;/a&gt;&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
        &lt;td&gt;Single &lt;a href=&#34;http://news.yahoo.com/s/ap/as_afghanistan;_ylt=AhRJzVLEo04_F09GGolXDKes0NUE;_ylu=X3oDMTNlNW5zdHBlBGFzc2V0A2FwLzIwMTAwNzA0L2FzX2FmZ2hhbmlzdGFuBGNjb2RlA21vc3Rwb3B1bGFyBGNwb3MDMQRwb3MDMgRwdANob21lX2Nva2UEc2VjA3luX3RvcF9zdG9yeQRzbGsDcGV0cmFldXN3ZWFy&#34; title=&#34;Petraeus: We are in this to win in Afghanistan&#34; rel=&#34;nofollow&#34;&gt;story&lt;/a&gt; on Yahoo! News&lt;/td&gt;
		&lt;td&gt;4&lt;/td&gt;
        &lt;td&gt;&lt;a href=&#34;http://www.webpagetest.org/result/100704_bf2f23029be14f1af65648beac250dfd/&#34; rel=&#34;nofollow&#34;&gt;5.310s&lt;/a&gt;&lt;/td&gt;
        &lt;td&gt;&lt;a href=&#34;http://www.webpagetest.org/result/100704_bf2f23029be14f1af65648beac250dfd/&#34; rel=&#34;nofollow&#34;&gt;2.335s&lt;/a&gt;&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
        &lt;td&gt;&lt;a href=&#34;http://www.nytimes.com/&#34;&gt;New York Times&lt;/a&gt;&lt;/td&gt;
	    &lt;td&gt;91&lt;/td&gt;
        &lt;td&gt;&lt;a href=&#34;http://www.webpagetest.org/result/100704_51db94d84d53e178ef38e759a5292467/&#34; rel=&#34;nofollow&#34;&gt;7.038s&lt;/a&gt;&lt;/td&gt;
        &lt;td&gt;&lt;a href=&#34;http://www.webpagetest.org/result/100704_51db94d84d53e178ef38e759a5292467/&#34; rel=&#34;nofollow&#34;&gt;2.200s&lt;/a&gt;&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
        &lt;td&gt;Single &lt;a href=&#34;http://www.nytimes.com/2010/07/04/business/04bptax.html&#34; title=&#34;As Oil Industry Fights a Tax, It Reaps Billions From Subsidies&#34;&gt;single&lt;/a&gt; story on NYT&lt;/td&gt;
	    &lt;td&gt;91&lt;/td&gt;
        &lt;td&gt;&lt;a href=&#34;http://www.webpagetest.org/result/100704_66d6d33534b86ca572123b08e08e9270/&#34; rel=&#34;nofollow&#34;&gt;4.650s&lt;/a&gt;&lt;/td&gt;
        &lt;td&gt;&lt;a href=&#34;http://www.webpagetest.org/result/100704_66d6d33534b86ca572123b08e08e9270/&#34; rel=&#34;nofollow&#34;&gt;4.507s&lt;/a&gt;&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
        &lt;td&gt;&lt;a href=&#34;http://www.bbc.co.uk/&#34;&gt;BBC&lt;/a&gt;&lt;/td&gt;
		&lt;td&gt;40&lt;/td&gt;
        &lt;td&gt;&lt;a href=&#34;http://www.webpagetest.org/result/100704_ac802e4531dbd9daab60b0d429a57c72/&#34; rel=&#34;nofollow&#34;&gt;7.485s&lt;/a&gt;&lt;/td&gt;
        &lt;td&gt;&lt;a href=&#34;http://www.webpagetest.org/result/100704_ac802e4531dbd9daab60b0d429a57c72/&#34; rel=&#34;nofollow&#34;&gt;3.427s&lt;/a&gt;&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
        &lt;td&gt;Single &lt;a href=&#34;http://news.bbc.co.uk/2/hi/middle_east/10500869.stm&#34; title=&#34;Hezbollah mentor Fadlallah dies in Lebanon&#34;&gt;story&lt;/a&gt; on BBC&lt;/td&gt;
		&lt;td&gt;40&lt;/td&gt;
        &lt;td&gt;&lt;a href=&#34;http://www.webpagetest.org/result/100704_24f6bc473e625429b56dc26cc9aa3192/&#34; rel=&#34;nofollow&#34;&gt;7.148s&lt;/a&gt;&lt;/td&gt;
        &lt;td&gt;&lt;a href=&#34;http://www.webpagetest.org/result/100704_24f6bc473e625429b56dc26cc9aa3192/&#34; rel=&#34;nofollow&#34;&gt;3.851s&lt;/a&gt;&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
        &lt;td&gt;&lt;a href=&#34;http://edition.cnn.com/&#34;&gt;CNN&lt;/a&gt;&lt;/td&gt;
		&lt;td&gt;58&lt;/td&gt;
        &lt;td&gt;&lt;a href=&#34;http://www.webpagetest.org/result/100703_2e1e879aecaf0ec4981d15e2f0deafa7/&#34; rel=&#34;nofollow&#34;&gt;10.197s&lt;/a&gt;&lt;/td&gt;
        &lt;td&gt;&lt;a href=&#34;http://www.webpagetest.org/result/100703_2e1e879aecaf0ec4981d15e2f0deafa7/&#34; rel=&#34;nofollow&#34;&gt;2.528s&lt;/a&gt;&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
        &lt;td&gt;An &lt;a href=&#34;http://edition.cnn.com/2010/WORLD/meast/07/03/munich.mastermind.dead/index.html&#34; title=&#34;Suspected Munich massacre mastermind dead, reports say&#34;&gt;Article&lt;/a&gt; on CNN&lt;/td&gt;
		&lt;td&gt;58&lt;/td&gt;
        &lt;td&gt;&lt;a href=&#34;http://www.webpagetest.org/result/100703_9c67e76e0e27e54b5d0f854a83b8d48b/&#34; rel=&#34;nofollow&#34;&gt;7.989s&lt;/a&gt;&lt;/td&gt;
        &lt;td&gt;&lt;a href=&#34;http://www.webpagetest.org/result/100703_9c67e76e0e27e54b5d0f854a83b8d48b/&#34; rel=&#34;nofollow&#34;&gt;3.523s&lt;/a&gt;&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
        &lt;td&gt;&lt;a href=&#34;http://www.msnbc.msn.com/&#34;&gt;MSNBC&lt;/a&gt;&lt;/td&gt;
		&lt;td&gt;9&lt;/td&gt;
        &lt;td&gt;&lt;a href=&#34;http://www.webpagetest.org/result/100704_4ea04da58d2e8576a4d9bd458c5f6bc9/&#34; rel=&#34;nofollow&#34;&gt;8.172s&lt;/a&gt;&lt;/td&gt;
        &lt;td&gt;&lt;a href=&#34;http://www.webpagetest.org/result/100704_4ea04da58d2e8576a4d9bd458c5f6bc9/&#34; rel=&#34;nofollow&#34;&gt;6.638s&lt;/a&gt;&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
        &lt;td&gt;Single &lt;a href=&#34;http://www.msnbc.msn.com/id/38082645/ns/world_news-americas/&#34; title=&#34;Drug war casts pall on Mexican elections&#34;&gt;story&lt;/a&gt; on MSNBC&lt;/td&gt;
		&lt;td&gt;9&lt;/td&gt;
        &lt;td&gt;&lt;a href=&#34;http://www.webpagetest.org/result/100704_454f2eb62ebb00ef25cef5674f00082e/&#34; rel=&#34;nofollow&#34;&gt;12.064s&lt;/a&gt;&lt;/td&gt;
        &lt;td&gt;&lt;a href=&#34;http://www.webpagetest.org/result/100704_454f2eb62ebb00ef25cef5674f00082e/&#34; rel=&#34;nofollow&#34;&gt;4.191s&lt;/a&gt;&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
        &lt;td&gt;&lt;a href=&#34;http://www.washingtonpost.com/&#34;&gt;The Washington Post&lt;/a&gt;&lt;/td&gt;
		&lt;td&gt;316&lt;/td&gt;
        &lt;td&gt;&lt;a href=&#34;http://www.webpagetest.org/result/100704_cfba18748623f2dc7253bddd0b22792e/&#34; rel=&#34;nofollow&#34;&gt;9.878s&lt;/a&gt;&lt;/td&gt;
        &lt;td&gt;&lt;a href=&#34;http://www.webpagetest.org/result/100704_cfba18748623f2dc7253bddd0b22792e/&#34; rel=&#34;nofollow&#34;&gt;3.828s&lt;/a&gt;&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
        &lt;td&gt;Single &lt;a href=&#34;http://www.washingtonpost.com/wp-dyn/content/article/2010/07/02/AR2010070204042.html&#34; title=&#34;Post policies fuel reader confusion on when writers can offer opinion&#34;&gt;story&lt;/a&gt; on WaPo&lt;/td&gt;
		&lt;td&gt;316&lt;/td&gt;
        &lt;td&gt;&lt;a href=&#34;http://www.webpagetest.org/result/100704_5f358d626dd80e82baae102a87306cd4/&#34; rel=&#34;nofollow&#34;&gt;15.435s&lt;/a&gt;&lt;/td&gt;
        &lt;td&gt;&lt;a href=&#34;http://www.webpagetest.org/result/100704_5f358d626dd80e82baae102a87306cd4/&#34; rel=&#34;nofollow&#34;&gt;4.530s&lt;/a&gt;&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
        &lt;td&gt;&lt;a href=&#34;http://abcnews.go.com/&#34;&gt;ABC News&lt;/a&gt;&lt;/td&gt;
		&lt;td&gt;492&lt;/td&gt;
        &lt;td&gt;&lt;a href=&#34;http://www.webpagetest.org/result/100704_195213d99f8ad424f594121ce0d90ec4/&#34; rel=&#34;nofollow&#34;&gt;14.761s&lt;/a&gt;&lt;/td&gt;
        &lt;td&gt;&lt;a href=&#34;http://www.webpagetest.org/result/100704_195213d99f8ad424f594121ce0d90ec4/&#34; rel=&#34;nofollow&#34;&gt;4.205s&lt;/a&gt;&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
        &lt;td&gt;Single &lt;a href=&#34;http://abcnews.go.com/International/wireStory?id=11082548&#34; title=&#34;Van Der Sloot Files Suit Against Initial Lawyer&#34;&gt;story&lt;/a&gt; on ABC News&lt;/td&gt;
		&lt;td&gt;492&lt;/td&gt;
        &lt;td&gt;&lt;a href=&#34;http://www.webpagetest.org/result/100704_1e67db2628f0d62d3440f9c91d648986/&#34; rel=&#34;nofollow&#34;&gt;8.697s&lt;/a&gt;&lt;/td&gt;
        &lt;td&gt;&lt;a href=&#34;http://www.webpagetest.org/result/100704_1e67db2628f0d62d3440f9c91d648986/&#34; rel=&#34;nofollow&#34;&gt;3.037s&lt;/a&gt;&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
        &lt;td&gt;&lt;a href=&#34;http://www.rollingstone.com/&#34;&gt;RollingStone&lt;/a&gt;&lt;/td&gt;
		&lt;td&gt;3,376&lt;/td&gt;
        &lt;td&gt;&lt;a href=&#34;http://www.webpagetest.org/result/100703_66004c5f83aedb432a3def54da60a187/&#34; rel=&#34;nofollow&#34;&gt;18.700s&lt;/a&gt;&lt;/td&gt;
        &lt;td&gt;&lt;a href=&#34;http://www.webpagetest.org/result/100703_66004c5f83aedb432a3def54da60a187/&#34; rel=&#34;nofollow&#34;&gt;3.572s&lt;/a&gt;&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
        &lt;td&gt;An &lt;a href=&#34;http://www.rollingstone.com/politics/matt-taibbi/blogs/TaibbiData_May2010/122137/83512&#34;&gt;article&lt;/a&gt; on RollingStone&lt;/td&gt;
		&lt;td&gt;3,376&lt;/td&gt;
        &lt;td&gt;&lt;a href=&#34;http://www.webpagetest.org/result/100703_23498c0f96dc6fa6e1f9c415f3b8c100/&#34; rel=&#34;nofollow&#34;&gt;10.707s&lt;/a&gt;&lt;/td&gt;
        &lt;td&gt;&lt;a href=&#34;http://www.webpagetest.org/result/100703_23498c0f96dc6fa6e1f9c415f3b8c100/&#34; rel=&#34;nofollow&#34;&gt;2.905s&lt;/a&gt;&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
        &lt;td&gt;&lt;a href=&#34;http://www.foxnews.com/&#34;&gt;Fox News&lt;/a&gt;&lt;/td&gt;
		&lt;td&gt;201&lt;/td&gt;
        &lt;td&gt;&lt;a href=&#34;http://www.webpagetest.org/result/100704_6caae51946f1b26a66543f08c2c2aaa9/&#34; rel=&#34;nofollow&#34;&gt;26.755s&lt;/a&gt;&lt;/td&gt;
        &lt;td&gt;&lt;a href=&#34;http://www.webpagetest.org/result/100704_6caae51946f1b26a66543f08c2c2aaa9/&#34; rel=&#34;nofollow&#34;&gt;8.761s&lt;/a&gt;&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
        &lt;td&gt;Single &lt;a href=&#34;http://www.foxnews.com/world/2010/07/03/van-der-sloot-files-suit-lawyer-charging-posing-public-defender/&#34; title=&#34;Van der Sloot files suit against first lawyer, charging him with posing as public defender&#34;&gt;story&lt;/a&gt; on Fox News&lt;/td&gt;
		&lt;td&gt;201&lt;/td&gt;
        &lt;td&gt;&lt;a href=&#34;http://www.webpagetest.org/result/100704_17b7f402a9d40f3a694a899b8919e371/&#34; rel=&#34;nofollow&#34;&gt;16.281s&lt;/a&gt;&lt;/td&gt;
        &lt;td&gt;&lt;a href=&#34;http://www.webpagetest.org/result/100704_17b7f402a9d40f3a694a899b8919e371/&#34; rel=&#34;nofollow&#34;&gt;5.839s&lt;/a&gt;&lt;/td&gt;
    &lt;/tr&gt;
&lt;/table&gt;
&lt;strong&gt;&lt;em&gt;The Sajal Kayan award&lt;/em&gt; for excellence in web development goes to &lt;em&gt;FOX News&lt;/em&gt;&lt;/strong&gt;
Test conditions :-
&lt;ul&gt;
    &lt;li&gt;&lt;em&gt;First View&lt;/em&gt; is simulated to act as the first time the visitor visits the website, the &lt;em&gt;Repeat view&lt;/em&gt; is when the user visits the website again after a while, probably closes and reopens the browser in between.&lt;/li&gt;
    &lt;li&gt;All tests were done on &lt;a href=&#34;http://www.microsoft.com/windows/internet-explorer/default.aspx&#34;&gt;Internet Explorer 8&lt;/a&gt;. Yes, I know you hate IE, I hate it more than you! But since the majority of the web uses this browser we test on IE8. Also IE8 performs significantly better than its predecessors. Some of the sites tested may take upto 2x the time to load on IE7 due to lower parallel downloads per host.&lt;/li&gt;
    &lt;li&gt;The tests were done from a test machine in Dulles, VA Provided by &lt;a href=&#34;http://dev.aol.com/&#34;&gt;AOL&lt;/a&gt; set to work at DSL speeds(1500 Kbps down, 384 Kbps up and 50ms latency)&lt;/li&gt;
    &lt;li&gt;The timings above show when the &lt;em&gt;window.onload&lt;/em&gt; event was triggered. It is possible that the page was usable well before that. Very rarely is also possible that for the page needs to do more stuff after onload in order to be usable.&lt;/li&gt;
    &lt;li&gt;Each test was repeated 5 times and its average was taken&lt;/li&gt;
    &lt;li&gt;I have tried to be as fair as possible in selection of pages for the test. I didnt use pages filled with videos/many images, etc.&lt;/li&gt;
    &lt;li&gt;Tests were conducted during this weekend(July 3rd and 4th) so traffic to those site would be much lower than usual.&lt;/li&gt;
&lt;/ul&gt;

You can see from the table above, that except for &lt;em&gt;Google News&lt;/em&gt;, &lt;em&gt;Yahoo! News&lt;/em&gt; and (to some extent) &lt;em&gt;The New York Times&lt;/em&gt; and &lt;em&gt;BBC&lt;/em&gt;, all other websites have not yet given a minute of thought on Frontend performance of their web pages. This needs to change. Even one of the biggest evangalist of Frontend performance Google, &lt;a href=&#34;http://www.webpagetest.org/result/100704_ba30dd802cd14323a2e2e840034cf0ce/5/performance_optimization/&#34; rel=&#34;nofollow&#34;&gt;forgot&lt;/a&gt; to set correct cache control headers for images on Google News.

I place more emphasis on individual story pages since those are the pages which a first time user would encounter first - coming via search, links, tweets etc...

Now, when browsing un-optimized sites from Thailand, the load times increased exponentially due to a much higher latency and occasional packet loss.

Finally! compare each of the above link &lt;a href=&#34;http://www.webpagetest.org/video/compare.php?tests=100704_WZY,100704_WZZ,100704_X00,100704_X01,100704_X02,100704_X03,100704_X04,100704_X05,100704_X06,100704_X07,100704_X08,100704_X09,100704_X0A,100704_X0B,100704_X0C,100704_X0D,100704_X0E,100704_X0F,100704_X0G,100704_X0H,100704_X0J,100704_X0K,100704_X0M,100704_X0N,100704_X0P,100704_X0Q,100704_X0R,100704_X0S,100704_X0T,100704_X0V,100704_X0W,100704_X0X,100704_X0Y&#34; rel=&#34;nofollow&#34;&gt;visually in IE7 in video mode&lt;/a&gt;. WaPo single story is missing due to a bug. For each URL, 3 first-view tests will be run from &#39;Dulles, VA - IE7&#39; and the median run will be used for comparison.

&lt;h4&gt;How to improve?&lt;/h4&gt;

Essential reading :-
&lt;ul&gt;
    &lt;li&gt;&lt;a href=&#34;http://developer.yahoo.com/performance/rules.html&#34;&gt;Yahoo! : Best Practices for Speeding Up Your Web Site&lt;/a&gt;&lt;/li&gt;
    &lt;li&gt;&lt;a href=&#34;http://code.google.com/speed/page-speed/docs/rules_intro.html&#34;&gt;Google : Web Performance Best Practices&lt;/a&gt;&lt;/li&gt;
    &lt;li&gt;&lt;a href=&#34;http://ronnysnewyorkpizza.com/about.html&#34;&gt;This awesome list of tools&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;

An optimizers goal should not be simply to get the total load time low. Thats important, but more important is the time in which the website kinda becomes usable. This for a news publishing site is being able to display the title and body of the story. The user can start reading the content while other parts of the website loads. This for &lt;a href=&#34;http://www.thaindian.com/&#34;&gt;Thaindian News&lt;/a&gt; story page hovers around 0.9 to 1.5 seconds!
</description>
    </item>
    
    <item>
      <title>In a CDN&#39;d world, OpenDNS is the enemy!</title>
      <link>https://www.sajalkayan.com/in-a-cdnd-world-opendns-is-the-enemy.html</link>
      <pubDate>Mon, 17 May 2010 17:19:30 +0000</pubDate>
      
      <guid>https://www.sajalkayan.com/in-a-cdnd-world-opendns-is-the-enemy.html</guid>
      <description>While many people are happy with using DNS service providers such as OpenDNS, Google, etc... I will show you here why they may not produce optimal results.

The way most &lt;a href=&#34;http://www.cdnplanet.com/&#34;&gt;CDNs&lt;/a&gt; work is by using DNS routing. When a user attempts to resolve a hostname, the CDN&#39;s DNS server responds with an IP which is closest based on the IP address of the requester. A more detailed insight into the workings of a CDN can be found on an earlier post &#34;&lt;a href=&#34;https://www.sajalkayan.com/make-your-own-cheap-charlie-cdn.html&#34;&gt;Make your own cheap charlie CDN&lt;/a&gt;&#34;

For my test here, I tested from the following locations listed below :-
&lt;ol&gt;
	&lt;li&gt;&lt;a href=&#34;http://www.asianet.co.th/&#34;&gt;True&lt;/a&gt; - Thailand : My personal internet connection provided by the ISP called True Internet.&lt;/li&gt;
	&lt;li&gt;&lt;a href=&#34;http://www.softlayer.com/&#34;&gt;Softlayer&lt;/a&gt; - United States : A server hosted at Softlayer&#39;s Washington DC Datacenter.&lt;/li&gt;
	&lt;li&gt;&lt;a href=&#34;http://aws.amazon.com/ec2/&#34;&gt;EC2&lt;/a&gt; - United States : An EC2 instance at Amazons us-east-1c availability zone.&lt;/li&gt;
	&lt;li&gt;&lt;a href=&#34;http://aws.amazon.com/ec2/&#34;&gt;EC2-EU&lt;/a&gt; - Ireland : An EC2 instance at Amazons eu-west-1 availability zone. - Thanks &lt;a href=&#34;http://twitter.com/LukeInTH&#34;&gt;Luke&lt;/a&gt;&lt;/li&gt;
	&lt;li&gt;&lt;a href=&#34;http://aws.amazon.com/ec2/&#34;&gt;EC2-APAC&lt;/a&gt; - Singapore : An EC2 instance at Amazons ap-southeast-1a availability zone.&lt;/li&gt;
	&lt;li&gt;&lt;a href=&#34;http://www.comhem.se/&#34;&gt;Com Hem&lt;/a&gt; - Sweden : An ISP in sweden. - Thanks &lt;a href=&#34;http://twitter.com/nadam9&#34;&gt;Adam&lt;/a&gt;&lt;/li&gt;
	&lt;li&gt;&lt;a href=&#34;http://www.tataindicombroadband.in/&#34;&gt;Tata&lt;/a&gt; - India : An ISP in India. - Thanks &lt;a href=&#34;http://gaeatimes.com/&#34;&gt;Angsuman&lt;/a&gt;&lt;/li&gt;
&lt;/ol&gt;
The following DNS servers were used to resolve the domains :-
&lt;ol&gt;
	&lt;li&gt;&lt;a href=&#34;http://www.opendns.com/&#34;&gt;OpenDNS&lt;/a&gt; (208.67.222.222 , 208.67.220.220 )- Has different caches in multiple locations(Anycasted) - Chicago, Illinois, USA; Dallas, Texas, USA; Los Angeles, California, USA; Miami, Florida, USA; New York, New York, USA; Palo Alto, California, USA; Seattle, Washington, USA; Washington, DC, USA; Amsterdam, The Netherlands and London, England, UK&lt;/li&gt;
	&lt;li&gt;&lt;a href=&#34;http://code.google.com/speed/public-dns/&#34;&gt;Google Public DNS&lt;/a&gt; (8.8.8.8 , 8.8.4.4 ) - &#34;Google Public DNS servers are available worldwide&#34; . I think Google has their DNS servers in all countries where they have hosting infrastructure.&lt;/li&gt;
	&lt;li&gt;Local DNS - The ISP provided DNS in the different locations.&lt;/li&gt;
&lt;/ol&gt;
The test was done to the following CDN providers :-
&lt;ol&gt;
	&lt;li&gt;&lt;a href=&#34;http://www.internap.com/&#34;&gt;Internap&lt;/a&gt; ( cdn.thaindian.com ) - Uses DNS routing. POPs (Point Of Presence) in the following locations : Atlanta; Boston; Chicago; Dallas; Denver; El Segundo; Houston; Miami; New York; Philadelphia; Phoenix; San Jose; Seattle; Washington, DC; Sydney; Tokyo; Singapore; Hong Kong; Amsterdam; London&lt;/li&gt;
	&lt;li&gt;&lt;a href=&#34;http://www.akamai.com/&#34;&gt;Akamai&lt;/a&gt; ( profile.ak.fbcdn.net ) - AFAIK they have a POP in almost all countries including Thailand. Note: Akamai does not entertain sales queries from Thai companies.&lt;/li&gt;
&lt;/ol&gt;
&lt;h3&gt;Results:-&lt;/h3&gt;
1) &lt;strong&gt;Internap&lt;/strong&gt; ( using cdn.thaindian.com )
&lt;table style=&#34;font-size: 8pt;&#34; border=&#34;1&#34;&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;th&gt;Location&lt;/th&gt;
&lt;th colspan=&#34;2&#34;&gt;Opendns&lt;/th&gt;
&lt;th colspan=&#34;2&#34;&gt;Google&lt;/th&gt;
&lt;th colspan=&#34;2&#34;&gt;Local&lt;/th&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;th&gt;&lt;/th&gt;
&lt;th&gt;IP Returned&lt;/th&gt;
&lt;th&gt;Ping to IP (ms)&lt;/th&gt;
&lt;th&gt;IP Returned&lt;/th&gt;
&lt;th&gt;Ping to IP (ms)&lt;/th&gt;
&lt;th&gt;IP Returned&lt;/th&gt;
&lt;th&gt;Ping to IP (ms)&lt;/th&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;th&gt;True (Thailand)&lt;/th&gt;
&lt;td&gt;64.94.126.65&lt;/td&gt;
&lt;td&gt;256&lt;/td&gt;
&lt;td&gt;74.201.0.130&lt;/td&gt;
&lt;td&gt;365&lt;/td&gt;
&lt;td&gt;203.190.126.131&lt;/td&gt;
&lt;td style=&#34;background-color: #ccff99;&#34;&gt;152&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;th&gt;Softlayer (US-East Coast)&lt;/th&gt;
&lt;td&gt;69.88.152.250&lt;/td&gt;
&lt;td style=&#34;background-color: #ccff99;&#34;&gt;1.253&lt;/td&gt;
&lt;td&gt;74.201.0.130&lt;/td&gt;
&lt;td&gt;25.69&lt;/td&gt;
&lt;td&gt;69.88.152.250&lt;/td&gt;
&lt;td&gt;1.388&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;th&gt;EC2 (US-East Coast)&lt;/th&gt;
&lt;td&gt;69.88.152.250&lt;/td&gt;
&lt;td&gt;2.144&lt;/td&gt;
&lt;td&gt;74.201.0.130&lt;/td&gt;
&lt;td&gt;20.229&lt;/td&gt;
&lt;td&gt;69.88.152.250&lt;/td&gt;
&lt;td style=&#34;background-color: #ccff99;&#34;&gt;2.094&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;th&gt;EC2 (Europe)&lt;/th&gt;
&lt;td&gt;77.242.194.130&lt;/td&gt;
&lt;td&gt;13.331&lt;/td&gt;
&lt;td&gt;64.7.222.130&lt;/td&gt;
&lt;td&gt;159.422&lt;/td&gt;
&lt;td&gt;77.242.194.130&lt;/td&gt;
&lt;td style=&#34;background-color: #ccff99;&#34;&gt;12.504&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;th&gt;EC2 (Singapore)&lt;/th&gt;
&lt;td&gt;64.94.126.65&lt;/td&gt;
&lt;td&gt;202&lt;/td&gt;
&lt;td&gt;74.201.0.130&lt;/td&gt;
&lt;td&gt;228&lt;/td&gt;
&lt;td&gt;202.58.12.98&lt;/td&gt;
&lt;td style=&#34;background-color: #ccff99;&#34;&gt;37.260&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;th&gt;Com Hem (Sweden)&lt;/th&gt;
&lt;td&gt;77.242.194.130&lt;/td&gt;
&lt;td&gt;40.035&lt;/td&gt;
&lt;td&gt;64.7.222.130&lt;/td&gt;
&lt;td&gt;189.647&lt;/td&gt;
&lt;td&gt;69.88.148.130&lt;/td&gt;
&lt;td style=&#34;background-color: #ccff99;&#34;&gt;36.310&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;th&gt;Tata (India)&lt;/th&gt;
&lt;td&gt;64.7.222.130&lt;/td&gt;
&lt;td&gt;313.2&lt;/td&gt;
&lt;td&gt;64.74.124.65&lt;/td&gt;
&lt;td&gt;304.1&lt;/td&gt;
&lt;td&gt;203.190.126.131&lt;/td&gt;
&lt;td style=&#34;background-color: #ccff99;&#34;&gt;150&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
2) &lt;strong&gt;Akamai&lt;/strong&gt; ( using profile.ak.fbcdn.net )
&lt;table style=&#34;font-size: 8pt;&#34; border=&#34;1&#34;&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;th&gt;Location&lt;/th&gt;
&lt;th colspan=&#34;2&#34;&gt;Opendns&lt;/th&gt;
&lt;th colspan=&#34;2&#34;&gt;Google&lt;/th&gt;
&lt;th colspan=&#34;2&#34;&gt;Local&lt;/th&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;th&gt;&lt;/th&gt;
&lt;th&gt;IP Returned&lt;/th&gt;
&lt;th&gt;Ping to IP (ms)&lt;/th&gt;
&lt;th&gt;IP Returned&lt;/th&gt;
&lt;th&gt;Ping to IP (ms)&lt;/th&gt;
&lt;th&gt;IP Returned&lt;/th&gt;
&lt;th&gt;Ping to IP (ms)&lt;/th&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;th&gt;True (Thailand)&lt;/th&gt;
&lt;td&gt;208.50.77.112&lt;/td&gt;
&lt;td&gt;239.4&lt;/td&gt;
&lt;td&gt;60.254.185.83&lt;/td&gt;
&lt;td&gt;138.9&lt;/td&gt;
&lt;td&gt;58.97.45.59&lt;/td&gt;
&lt;td style=&#34;background-color: #ccff99;&#34;&gt;18.88&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;th&gt;Softlayer (US-East Coast)&lt;/th&gt;
&lt;td&gt;72.246.31.57&lt;/td&gt;
&lt;td&gt;1.312&lt;/td&gt;
&lt;td&gt;72.246.31.42&lt;/td&gt;
&lt;td&gt;1.262&lt;/td&gt;
&lt;td&gt;24.143.196.88&lt;/td&gt;
&lt;td style=&#34;background-color: #ccff99;&#34;&gt;0.877&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;th&gt;EC2 (US-East Coast)&lt;/th&gt;
&lt;td&gt;72.246.31.73&lt;/td&gt;
&lt;td&gt;2.581&lt;/td&gt;
&lt;td&gt;72.246.31.25&lt;/td&gt;
&lt;td style=&#34;background-color: #ccff99;&#34;&gt;1.792&lt;/td&gt;
&lt;td&gt;72.247.242.51&lt;/td&gt;
&lt;td&gt;1.941&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;th&gt;EC2 (Europe)&lt;/th&gt;
&lt;td&gt;195.59.150.139&lt;/td&gt;
&lt;td style=&#34;background-color: #ccff99;&#34;&gt;13.449&lt;/td&gt;
&lt;td&gt;92.122.207.177&lt;/td&gt;
&lt;td&gt;29.022&lt;/td&gt;
&lt;td&gt;195.59.150.138&lt;/td&gt;
&lt;td&gt;13.516&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;th&gt;EC2 (Singapore)&lt;/th&gt;
&lt;td&gt;208.50.77.94&lt;/td&gt;
&lt;td&gt;202&lt;/td&gt;
&lt;td&gt;60.254.185.73&lt;/td&gt;
&lt;td&gt;71.7&lt;/td&gt;
&lt;td&gt;124.155.222.10&lt;/td&gt;
&lt;td style=&#34;background-color: #ccff99;&#34;&gt;7.052&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;th&gt;Com Hem (Sweden)&lt;/th&gt;
&lt;td&gt;217.243.192.8&lt;/td&gt;
&lt;td&gt;51.73&lt;/td&gt;
&lt;td&gt;92.123.69.82&lt;/td&gt;
&lt;td&gt;35.972&lt;/td&gt;
&lt;td&gt;92.123.155.139&lt;/td&gt;
&lt;td style=&#34;background-color: #ccff99;&#34;&gt;13.212&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;th&gt;Tata (India)&lt;/th&gt;
&lt;td&gt;209.18.46.113&lt;/td&gt;
&lt;td&gt;300&lt;/td&gt;
&lt;td&gt;203.106.85.33&lt;/td&gt;
&lt;td&gt;196&lt;/td&gt;
&lt;td&gt;125.252.226.58&lt;/td&gt;
&lt;td style=&#34;background-color: #ccff99;&#34;&gt;100.5&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
The ping timings represent the lag to the destination server from the location in question. I will try to update the results from more locations if I can get shell access to a server or PC in other countries. If you are willing to run the tests for me please contact me(or post in comments)
&lt;h3&gt;Conclusion&lt;/h3&gt;
Using OpenDNS or Google Public DNS may be fast in resolving the DNS, but they do not give the ideal results.

In the case of Global DNS providers, the IP of the original requester is not passed along to the CDN&#39;s DNS servers so they are unable to route the user to the nearest POP.

As you can see in the result tables above, when using OpenDNS from Thailand, trying to access static assets of Facebook, I am directed to a server in the USA whereas when using Google&#39;s DNS i am directed to a server in Japan and when using my ISP&#39;s DNS server I access content locally, hosted within my own ISPs network!

While the effect on large websites using CDN is significant, smaller non-CDN&#39;d websites are also effected. Most websites embed widgets, advertising and other assets which are likely to be CDN&#39;d.

The solution would be to use your ISPs DNS server rather than these Global providers. If they really suck so bad, its fairly simple to set up BIND as a caching recursive resolver to resolve hostnames directly bypassing the ISPs crappy service.

&lt;a href=&#34;http://www.linkedin.com/in/billf&#34;&gt;Bill Fumerola&lt;/a&gt;, ex-director of network engineering at OpenDNS &lt;a href=&#34;http://forums.opendns.com/comments.php?DiscussionID=1096#Item_7&#34;&gt;confirms this problem&lt;/a&gt; on OpenDNS forums.

You can run the tests from your own computer using this simple script: &lt;a href=&#34;https://www.sajalkayan.com/dnstest.py&#34; target=&#34;_blank&#34;&gt;dnstest.py&lt;/a&gt;

Here is the named.conf for a recursive server. Set your computer to use 127.0.0.1 as the DNS. - config may differ for you, RTFM and adapt accordingly.
&lt;pre&gt;options {
        directory &#34;/var/named&#34;;
        listen-on {
		127.0.0.1;
        };
        auth-nxdomain yes;
        allow-recursion {
                127.0.0.1;
        };
        dump-file       &#34;/var/named/data/cache_dump.db&#34;;
        statistics-file &#34;/var/named/data/named_stats.txt&#34;;
        memstatistics-file &#34;/var/named/data/named_mem_stats.txt&#34;;

};

//
// a caching only nameserver config
//
zone &#34;.&#34; {
        type hint;
        file &#34;named.ca&#34;;
};

include &#34;/etc/named.rfc1912.zones&#34;;

include &#34;/etc/named.dnssec.keys&#34;;
include &#34;/etc/pki/dnssec-keys/dlv/dlv.isc.org.conf&#34;;&lt;/pre&gt;
EDIT 1: Inverted the axis added test data from Europe
EDIT 2: Added test data from Singapore
EDIT 3: Added test data from Sweden
EDIT 4: Added test data from India
EDIT 5: Added link to Bill Fumerolas explanation of the problem.

&lt;h3&gt;Shameless plug&lt;/h3&gt;
&lt;a href=&#34;http://www.turbobytes.com/&#34;&gt;Turbobytes&lt;/a&gt; - Faster content delivery using multiple CDNs

</description>
    </item>
    
    <item>
      <title>Future releases of Firefox to speed page load time considerably?</title>
      <link>https://www.sajalkayan.com/future-releases-of-firefox-to-speed-page-load-time-considerabilly.html</link>
      <pubDate>Wed, 20 Jan 2010 14:29:58 +0000</pubDate>
      
      <guid>https://www.sajalkayan.com/future-releases-of-firefox-to-speed-page-load-time-considerabilly.html</guid>
      <description>Living in Thailand has its fair share of disadvantages. The most prominent being bad internet and poor response times. In most cases, the packet shaping, caching and filtering mechanisms use by ISPs do more harm than good. A response from a US server may take anywhere between 100 to 1000 ms extra than it should (not counting the ping lag and server processing overhead, etc). These days, most websites integrate a lot of client side external scripts and APIs, lagging responses make for a horrible user experience.

Especially when within one ad code, I have a default ad code and that too has a default. This means, when an impression is trying to be filled, the ad network decides, if they can fill the impression based on parameters I set or not. If not, then they pass the impression down the chain to another network. It goes on until the end network. In my case the chain is mostly 3 networks. I cant increase it as it results in a poorer user experience.

&lt;img src=&#34;https://www.sajalkayan.com/wmt-performance-chart.png&#34; border=&#34;0&#34; alt=&#34;Google Webmaster Tools&#34; width=&#34;500&#34; height=&#34;94&#34; /&gt;

Recently, Google started showing average response times in &lt;a href=&#34;https://www.google.com/webmasters/tools/home?hl=en&#34;&gt;Google Webmaster Tools&lt;/a&gt; so, Ive started worrying about these things more than I should.

On &lt;a title=&#34;Thaindian News&#34; href=&#34;http://www.thaindian.com/newsportal/&#34;&gt;my site&lt;/a&gt;, I have 2 ad blocks(leaderboard, skyscraper and another block which shows up on individual story pages) which load up before the main content page. Recently I moved the ads to Google ad manager which has a &lt;a href=&#34;http://www.google.com/support/admanager/bin/answer.py?hl=en&amp;amp;answer=94394&#34;&gt;wonderful way of debugging ad loading&lt;/a&gt; by adding ?google_debug to the end of the URL.

My first impression of &lt;a href=&#34;https://www.google.com/admanager&#34;&gt;Google ad manager&lt;/a&gt; was excellent. My page was no more held up while the ads loaded, but soon I realized thats not an admanager feature, it is &lt;strong&gt;firefox 3.5.8pre&lt;/strong&gt; which is speeding things up.

&lt;a rel=&#34;lightbox&#34; href=&#34;https://www.sajalkayan.com/ff-3.5.8pre-ubuntu-big.png&#34;&gt; &lt;img src=&#34;https://www.sajalkayan.com/ff-3.5.8pre-ubuntu.png&#34; alt=&#34;&#34; /&gt;&lt;/a&gt;

Browsers Useragent : &lt;em&gt;Mozilla/5.0 (X11; U; Linux x86_64; en-US; rv:1.9.1.8pre) Gecko/20100116 Ubuntu/9.04 (jaunty) Shiretoko/3.5.8pre&lt;/em&gt; (Click image for full screenshot)

My tests on my laptop shows otherwise. (it runs 3.0.17).

&lt;a rel=&#34;lightbox&#34; href=&#34;https://www.sajalkayan.com/ff-3.0-ubuntu-big.png&#34;&gt; &lt;img src=&#34;https://www.sajalkayan.com/ff-3.0-ubuntu.png&#34; alt=&#34;&#34; /&gt;&lt;/a&gt;

Browsers Useragent: &lt;em&gt;Mozilla/5.0 (X11; U; Linux x86_64; en-US; rv:1.9.0.16) Gecko/2009121601 Ubuntu/9.04 (jaunty) Firefox/3.0.17&lt;/em&gt; (Click on image for full screenshot)

This does not speed up much on Chrome or IE too... They all show that the &#34;Time the page is blocked fetching ads from Google&#34; to range between 1000ms to 2500ms. The variation is irrelevant its due to network issues and ad server response times. But the bottom line is that these browsers do hold up the page while the ads load.

Maybe this is an improvement in the latest Ubuntu nightly build or a general improvement, whatever it is, the future is &lt;a href=&#34;http://www.getfirefox.com/&#34;&gt;Firefox&lt;/a&gt; and they are &lt;a href=&#34;http://www.mozilla.com/en-US/firefox/fastest/&#34;&gt;fast&lt;/a&gt;!

So far, there has been no proper way to load ads such that they don&#39;t block the rest of the page from loading. The 2 ways i know of are very ugly and I don&#39;t like them :-
&lt;ol&gt;
	&lt;li&gt;Load the target adscript from a separate HTML file loaded via iframe - costs one extra request/ad code, may screw up ad targeting, etc.&lt;/li&gt;
	&lt;li&gt;Place a blank hidden div in place of ad, load the ad in a hidden div below the actual content and then using javascript trickery swap contents of the hidden div with this ad div. - sounds ugly again. not a neat solution.&lt;/li&gt;
&lt;/ol&gt;
Of course there is a neat and ideal solution... which is to make your template in such a way(CSS absolute positioning or something) such that the HTML of the content appears before in the code than the ad javascript... but again this is cumbersome. &lt;a href=&#34;http://www.google.com/support/forum/p/Google+Ad+Manager/thread?tid=4e3c789b45f46902&amp;amp;hl=en&#34;&gt;Interesting discussion here&lt;/a&gt;.

In an ideal world, all ad networks would be banned from using &lt;em&gt;document.write&lt;/em&gt; in their scripts and use some form of ajax to call the banner code after(or during) rest of the page has loaded. Its not 2001 anymore!

Here is what I request from you, open the following URL &lt;a href=&#34;http://www.thaindian.com/newsportal/?google_debug&#34;&gt;http://www.thaindian.com/newsportal/?google_debug&lt;/a&gt; then there should be 1 or 2 popups(maybe some browsers need to disable popup blocker). Look at the popup which resembles the &lt;a rel=&#34;lightbox&#34; href=&#34;https://www.sajalkayan.com/ff-3.0-ubuntu-big.png&#34;&gt;screenshots&lt;/a&gt; above, and report your findings in the comments below. Be sure to wait for the main page to complete loading and don&#39;t forget to include your full useragent. If you can upload screenshots somewhere then please drop their URLs in comments too.

The info i need, could be like the following example:-

&lt;em&gt;User Agent: Mozilla/5.0 (X11; U; Linux x86_64; en-US; rv:1.9.1.8pre) Gecko/20100116 Ubuntu/9.04 (jaunty) Shiretoko/3.5.8pre
Debug: -
7342	Information  	Time the page is blocked fetching ads from Google 0 ms
7343	Information  	Time the page is blocked rendering ads from Google 0 ms&lt;/em&gt;
Your useragent can be checked &lt;a href=&#34;http://whatsmyuseragent.com/&#34;&gt;here&lt;/a&gt;.

Video of pageload on Google Chrome:-
&lt;object width=&#34;480&#34; height=&#34;385&#34;&gt;&lt;param name=&#34;movie&#34; value=&#34;http://www.youtube.com/v/M6B9t2tbwx0&amp;hl=en_US&amp;fs=1&amp;&#34;&gt;&lt;/param&gt;&lt;param name=&#34;allowFullScreen&#34; value=&#34;true&#34;&gt;&lt;/param&gt;&lt;param name=&#34;allowscriptaccess&#34; value=&#34;always&#34;&gt;&lt;/param&gt;&lt;embed src=&#34;http://www.youtube.com/v/M6B9t2tbwx0&amp;hl=en_US&amp;fs=1&amp;&#34; type=&#34;application/x-shockwave-flash&#34; allowscriptaccess=&#34;always&#34; allowfullscreen=&#34;true&#34; width=&#34;480&#34; height=&#34;385&#34;&gt;&lt;/embed&gt;&lt;/object&gt;

Video of pageload on Firefox 3.6pre(Ubuntu build):-
&lt;object width=&#34;480&#34; height=&#34;385&#34;&gt;&lt;param name=&#34;movie&#34; value=&#34;http://www.youtube.com/v/4SIMl8IEZsg&amp;hl=en_US&amp;fs=1&amp;&#34;&gt;&lt;/param&gt;&lt;param name=&#34;allowFullScreen&#34; value=&#34;true&#34;&gt;&lt;/param&gt;&lt;param name=&#34;allowscriptaccess&#34; value=&#34;always&#34;&gt;&lt;/param&gt;&lt;embed src=&#34;http://www.youtube.com/v/4SIMl8IEZsg&amp;hl=en_US&amp;fs=1&amp;&#34; type=&#34;application/x-shockwave-flash&#34; allowscriptaccess=&#34;always&#34; allowfullscreen=&#34;true&#34; width=&#34;480&#34; height=&#34;385&#34;&gt;&lt;/embed&gt;&lt;/object&gt;

&lt;strong&gt;UPDATE&lt;/strong&gt;: I upgraded my main browser to Firefox 3.6 (Your User Agent: Mozilla/5.0 (&lt;em&gt;X11; U; Linux x86_64; en-US; rv:1.9.2pre) Gecko/20100120 Ubuntu/9.04 (jaunty) Namoroka/3.6pre&lt;/em&gt;) same results as 3.5.8pre its bloody fast and doesn&#39;t stall the pageload waiting for ads.

&lt;strong&gt;UPDATE 2:&lt;/strong&gt; Based on comment by Archit below, the speed improvement is not visible on 3.6rc2 . My conclusions are based on the nightly builds by the &lt;a href=&#34;https://launchpad.net/~ubuntu-mozilla-daily&#34;&gt;Ubuntu Mozilla Daily Build Team&lt;/a&gt;

&lt;strong&gt;UPDATE 3:&lt;/strong&gt; Added videos

&lt;strong&gt;UPDATE 4:&lt;/strong&gt; For my site I implemented the hidden div trick, so for now, all browsers will not notice the visual delay.
</description>
    </item>
    
    <item>
      <title>Make your own cheap charlie CDN</title>
      <link>https://www.sajalkayan.com/make-your-own-cheap-charlie-cdn.html</link>
      <pubDate>Sat, 28 Jun 2008 05:26:21 +0000</pubDate>
      
      <guid>https://www.sajalkayan.com/make-your-own-cheap-charlie-cdn.html</guid>
      <description>&lt;a href=&#34;http://en.wikipedia.org/wiki/Content_Delivery_Network&#34; target=&#34;_self&#34;&gt;CDN&lt;/a&gt; stands for Content Delivery(or Distribution) Network. It is a network of servers usually located in various geographic locations to improve the availability and access speed of a website (or webapp or other media). The main use of CDNs were during the nineteens when inter-continental access was slow, scarce and expensive. Origin server could be in the silicon valley, users from UK would access the node located in UK, so in theory only once the page would be downloaded from the US server to the UK server. Thus allowing the UK visitors to access the page locally resulting in a huge saving in inter-continental bandwidth costs and improved access times for the end users.

CDNs are traditionally a very expensive solution to implement if using any of the &lt;a href=&#34;http://en.wikipedia.org/wiki/Content_Delivery_Network#Commercial_CDNs&#34;&gt;established providers&lt;/a&gt;. The solution in itself is not very complex. I am in the process of implementing my very own CDN. The benefits are simple.
&lt;ul&gt;
	&lt;li&gt;It would reduce load on the origin server&lt;/li&gt;
	&lt;li&gt;Faster access if user downloads pages from a server closer to them&lt;/li&gt;
	&lt;li&gt;Since load on origin server is low, faster access even if cache needs to be refreshed&lt;/li&gt;
&lt;/ul&gt;
Some major portions of the CDN I am looking to implement
&lt;ol&gt;
	&lt;li&gt;&lt;strong&gt;Origin Server(s)&lt;/strong&gt;&lt;/li&gt;
	&lt;li&gt;&lt;strong&gt;Geo targeting DNS servers&lt;/strong&gt;&lt;/li&gt;
	&lt;li&gt;&lt;strong&gt;Squid Cache&lt;/strong&gt; - Set as Reverse Proxy or web accelerator&lt;/li&gt;
&lt;/ol&gt;
&lt;!--more--&gt;&lt;strong&gt;Origin Server&lt;/strong&gt; : This at the moment is a single server, which may be increased to run mysql and apache on separate boxes to increase productivity. This is up and running and in production.

&lt;strong&gt;Geo targeting DNS servers&lt;/strong&gt; : A perl script making use of Geo::IP and Net::DNS::Nameserver modules to resolve the query based on the origin country of the requester. The DNS script is in very early development. At the moment it is basically the example usage of Net::DNS::Nameserver with the Geo::IP loosely implemented. Need to implement some way of using config files which flush every 10 minutes, so I can use a series of servers runing this script and changes in config can be done on one server and rsynced across all nameservers running this script. The perl script is attached in the end. It would resolve foo.example.com differently if the request came from Malaysia.
&lt;strong&gt;
Squid Cache&lt;/strong&gt; : Squid cache is an Free proxy server which can be setup as a Reverse proxy. Users would query this proxy for pages and the proxy would deliver content, flushing the cache based on the rules defined in the squid.conf file and/or the expires headers tag set by the origin server. It can be setup such that different filetypes are cached in a different manner. Different url patterns need to be cached differently. Queries to some URL patterns by logged-in(based on cookies) users should be direct from origin server. These configurations are a little complicated. My plan for this configuration is attached in the end.

The Geo Dns and Squid would be installed on cheap VPS in a few countries. Will start with one to see how well it scales.

EDIT 1 : Playing with &lt;a href=&#34;http://varnish.projects.linpro.no/&#34;&gt;Varnish&lt;/a&gt; at the moment, considering it over squid.

The Geo Dns perl script :
&lt;pre lang=&#34;perl&#34;&gt;#!/usr/bin/perl

use Geo::IP;
use Net::DNS::Nameserver;
use strict;
use warnings;

sub reply_handler {
my ($qname, $qclass, $qtype, $peerhost,$query) = @_;
my ($rcode, @ans, @auth, @add);

my $gi = Geo::IP-&amp;gt;new(GEOIP_STANDARD);
print &#34;Received query from $peerhost\n&#34;;
my $ip = substr $peerhost, 7;
my $country = $gi-&amp;gt;country_code_by_addr($ip);
print &#34;--$ip--$country \n\n&#34;;
$query-&amp;gt;print;

if ($qtype eq &#34;A&#34; &amp;amp;&amp;amp; $qname eq &#34;foo.example.com&#34; ) {
my ($ttl, $rdata) = (3600, &#34;10.1.2.3&#34;);
if ($country eq &#34;MY&#34; ) {
$rdata = &#34;10.1.2.4&#34;;
}
push @ans, Net::DNS::RR-&amp;gt;new(&#34;$qname $ttl $qclass $qtype $rdata&#34;);
$rcode = &#34;NOERROR&#34;;
}elsif( $qname eq &#34;foo.example.com&#34; ) {
$rcode = &#34;NOERROR&#34;;

}else{
$rcode = &#34;NXDOMAIN&#34;;
}

# mark the answer as authoritive (by setting the &#39;aa&#39; flag
return ($rcode, \@ans, \@auth, \@add, { aa =&amp;gt; 1 });
}

my $ns = Net::DNS::Nameserver-&amp;gt;new(
LocalPort =&amp;gt; 53,
ReplyHandler =&amp;gt; \&amp;amp;reply_handler,

Verbose =&amp;gt; 1,
) || die &#34;couldn&#39;t create nameserver object\n&#34;;

$ns-&amp;gt;main_loop;&lt;/pre&gt;
My idea for squid.conf :
&lt;pre lang=&#34;html&#34;&gt;1) Forward proxy :-

Allow following IPs to browse any website without any caching... allow https also...

a.b.c.d
w.x.y.z
127.0.0.1 (ill do a ssh tunnel)

2) Reverse proxy :-

Rules (to be followed serially, if rule 3 and 5 both match, rule 3 should be used):-

1) All urls ending in the following must be cached for minimum 5 days or expires headder. dont even check to see if file has updated.

.jpg, .gif, .css, .js, .swf, .png (not case sensitive )

2) POST should never be cached

3) Few URLs should be cached for 30 mins (minimum/maximum) no matter what the expires headder says.

http://www.mysite.com/urla/
http://www.mysite.com/urlc.html
etc...

4) Requests to http://www.mysite.com/sectiona/* :-

* If user has following cookies pass them direct hint : &#34;acl cookie_test req_header Cookie ^.*(comment_author_|wordpress|wp-postpass_).*$&#34;
* http://www.mysite.com/sectiona/sub-section1/* : 30 mins cache no matter what!
* If requester is Googlebot : serve from cache only if it the copy in cache is 5 mins old. else update the cache.
* for other users cache urls ending in .html for 60 mins , rest for 20 mins

5) Requests to http://www.mysite.com/sectionb/*

* no cache unless images.
* Allow access only if user has a particular cookie e.g. secret_word=another_word

6) urls which are NOT in point 4 or 5 :-

* If users have cookie eg. no_cache then pass direct
* 5 min cache for http://www.mysite.com/sectionc/*
* Cache the shit out of everything else for 30 mins

Special Instructions : If origin server is unreachable then show cached result, no matter what. The first cache server is a VPS running ubuntu server with 128 megs of dedicated non-burstable ram and has 4.3 GB diskspace left. resources can be upgraded on request. Where I have mentioned &#34;no matter what&#34; i dont want the proxy server bothering the origin server at all. The origin and proxies will be located far geographically so connection between them may not be optimal.

In case squid allows for URL rewriting, i would like to also map for example :-
us.mysite.com -&amp;gt; www.mysite.com

so if user can access the same stuff by going to www.mysite.com or even us.mysite.com

Also if URL rewriting is possible in Squid, in the future id like to be able to map ... http://www.mysite.com/subfolder as http://somesite.com/subfolder and http://www.mysite.com/anotherfolder as http://anothersite.com/anotherfolder

Also.. if squid supports ssl, would it be possible to use https (and also install some certificate on the squid) then users connection to and from the proxy is encrypted if needed, but the connection between squid and origin server is plaintext ?&lt;/pre&gt;
</description>
    </item>
    
  </channel>
</rss>